/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/listings/my/route";
exports.ids = ["app/api/listings/my/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Flistings%2Fmy%2Froute&page=%2Fapi%2Flistings%2Fmy%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Flistings%2Fmy%2Froute.ts&appDir=C%3A%5Cprojects%5Cb2bsites%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cprojects%5Cb2bsites&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Flistings%2Fmy%2Froute&page=%2Fapi%2Flistings%2Fmy%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Flistings%2Fmy%2Froute.ts&appDir=C%3A%5Cprojects%5Cb2bsites%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cprojects%5Cb2bsites&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handler: () => (/* binding */ handler),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/server/request-meta */ \"(rsc)/./node_modules/next/dist/server/request-meta.js\");\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(rsc)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/app-paths */ \"next/dist/shared/lib/router/utils/app-paths\");\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/base-http/node */ \"(rsc)/./node_modules/next/dist/server/base-http/node.js\");\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/dist/server/web/spec-extension/adapters/next-request */ \"(rsc)/./node_modules/next/dist/server/web/spec-extension/adapters/next-request.js\");\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(rsc)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! next/dist/server/instrumentation/utils */ \"(rsc)/./node_modules/next/dist/server/instrumentation/utils.js\");\n/* harmony import */ var next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! next/dist/server/send-response */ \"(rsc)/./node_modules/next/dist/server/send-response.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! next/dist/server/web/utils */ \"(rsc)/./node_modules/next/dist/server/web/utils.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! next/dist/server/lib/cache-control */ \"(rsc)/./node_modules/next/dist/server/lib/cache-control.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! next/dist/lib/constants */ \"(rsc)/./node_modules/next/dist/lib/constants.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! next/dist/shared/lib/no-fallback-error.external */ \"next/dist/shared/lib/no-fallback-error.external\");\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__);\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! next/dist/server/response-cache */ \"(rsc)/./node_modules/next/dist/server/response-cache/index.js\");\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var C_projects_b2bsites_src_app_api_listings_my_route_ts__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./src/app/api/listings/my/route.ts */ \"(rsc)/./src/app/api/listings/my/route.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/listings/my/route\",\n        pathname: \"/api/listings/my\",\n        filename: \"route\",\n        bundlePath: \"app/api/listings/my/route\"\n    },\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || '',\n    resolvedPagePath: \"C:\\\\projects\\\\b2bsites\\\\src\\\\app\\\\api\\\\listings\\\\my\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_projects_b2bsites_src_app_api_listings_my_route_ts__WEBPACK_IMPORTED_MODULE_16__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\nasync function handler(req, res, ctx) {\n    var _nextConfig_experimental;\n    let srcPage = \"/api/listings/my/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {} else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = false;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname } = prepareResult;\n    const normalizedSrcPage = (0,next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__.normalizeAppPath)(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                throw new next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isRevalidate = isIsr && !supportsDynamicResponse;\n    const method = req.method || 'GET';\n    const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.getTracer)();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                cacheComponents: Boolean(nextConfig.experimental.cacheComponents),\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            supportsDynamicResponse,\n            incrementalCache: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'incrementalCache'),\n            cacheLifeProfiles: (_nextConfig_experimental = nextConfig.experimental) == null ? void 0 : _nextConfig_experimental.cacheLife,\n            isRevalidate,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext)=>routeModule.onRequestError(req, error, errorContext, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextRequest(req);\n    const nodeNextRes = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextResponse(res);\n    const nextReq = next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.NextRequestAdapter.fromNodeNextRequest(nodeNextReq, (0,next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.signalFromNodeResponse)(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        };\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.toNodeOutgoingHttpHeaders)(response.headers);\n                        if (cacheTags) {\n                            headers[next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                                isRevalidate,\n                                isOnDemandRevalidate\n                            })\n                        }, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode')) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.fromNodeOutgoingHttpHeaders)(cacheEntry.value.headers);\n            if (!((0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isIsr)) {\n                headers.delete(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', (0,next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__.getCacheControlHeader)(cacheEntry.cacheControl));\n            }\n            await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        if (!(err instanceof next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError)) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                    isRevalidate,\n                    isOnDemandRevalidate\n                })\n            });\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZsaXN0aW5ncyUyRm15JTJGcm91dGUmcGFnZT0lMkZhcGklMkZsaXN0aW5ncyUyRm15JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGbGlzdGluZ3MlMkZteSUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDcHJvamVjdHMlNUNiMmJzaXRlcyU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q3Byb2plY3RzJTVDYjJic2l0ZXMmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QmaXNHbG9iYWxOb3RGb3VuZEVuYWJsZWQ9ISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUErRjtBQUN2QztBQUNxQjtBQUNkO0FBQ1M7QUFDTztBQUNLO0FBQ21DO0FBQ2pEO0FBQ087QUFDZjtBQUNzQztBQUN6QjtBQUNNO0FBQ0M7QUFDaEI7QUFDd0I7QUFDMUY7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHlHQUFtQjtBQUMzQztBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsYUFBYSxPQUFvQyxJQUFJLENBQUU7QUFDdkQsd0JBQXdCLE1BQXVDO0FBQy9EO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsc0RBQXNEO0FBQzlEO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzBGO0FBQ25GO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsS0FBcUIsRUFBRSxFQUUxQixDQUFDO0FBQ047QUFDQTtBQUNBO0FBQ0EsK0JBQStCLEtBQXdDO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLG9KQUFvSjtBQUNoSyw4QkFBOEIsNkZBQWdCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQiw2RkFBZTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQiw0RUFBUztBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsOEJBQThCLDZFQUFjO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qiw0RUFBZTtBQUMzQyw0QkFBNEIsNkVBQWdCO0FBQzVDLG9CQUFvQix5R0FBa0Isa0NBQWtDLGlIQUFzQjtBQUM5RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLGdGQUFjO0FBQy9FLCtEQUErRCx5Q0FBeUM7QUFDeEc7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsUUFBUSxFQUFFLE1BQU07QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSxrQkFBa0I7QUFDbEIsdUNBQXVDLFFBQVEsRUFBRSxRQUFRO0FBQ3pEO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyxvQkFBb0I7QUFDbkU7QUFDQSx5QkFBeUIsNkVBQWM7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxzRkFBeUI7QUFDakU7QUFDQSxvQ0FBb0MsNEVBQXNCO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0pBQXNKLG9FQUFjO0FBQ3BLLDBJQUEwSSxvRUFBYztBQUN4SjtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MsNkVBQWU7QUFDckQ7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBLDhCQUE4Qiw2RUFBWTtBQUMxQztBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLDJGQUFtQjtBQUNqRTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLGtFQUFTO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUlBQXFJLDZFQUFlO0FBQ3BKO0FBQ0EsMkdBQTJHLGlIQUFpSDtBQUM1TjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxpQkFBaUIsNkVBQWM7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHdGQUEyQjtBQUN2RCxrQkFBa0IsNkVBQWM7QUFDaEMsK0JBQStCLDRFQUFzQjtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QywwRkFBcUI7QUFDbEU7QUFDQSxrQkFBa0IsNkVBQVk7QUFDOUI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1YsNkVBQTZFLGdGQUFjO0FBQzNGLGlDQUFpQyxRQUFRLEVBQUUsUUFBUTtBQUNuRCwwQkFBMEIsdUVBQVE7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxNQUFNO0FBQ04sNkJBQTZCLDZGQUFlO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLDJGQUFtQjtBQUNyRDtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyw2RUFBWTtBQUMxQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUEiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgeyBnZXRSZXF1ZXN0TWV0YSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JlcXVlc3QtbWV0YVwiO1xuaW1wb3J0IHsgZ2V0VHJhY2VyLCBTcGFuS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS90cmFjZXJcIjtcbmltcG9ydCB7IG5vcm1hbGl6ZUFwcFBhdGggfSBmcm9tIFwibmV4dC9kaXN0L3NoYXJlZC9saWIvcm91dGVyL3V0aWxzL2FwcC1wYXRoc1wiO1xuaW1wb3J0IHsgTm9kZU5leHRSZXF1ZXN0LCBOb2RlTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvYmFzZS1odHRwL25vZGVcIjtcbmltcG9ydCB7IE5leHRSZXF1ZXN0QWRhcHRlciwgc2lnbmFsRnJvbU5vZGVSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3dlYi9zcGVjLWV4dGVuc2lvbi9hZGFwdGVycy9uZXh0LXJlcXVlc3RcIjtcbmltcG9ydCB7IEJhc2VTZXJ2ZXJTcGFuIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3RyYWNlL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgZ2V0UmV2YWxpZGF0ZVJlYXNvbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2luc3RydW1lbnRhdGlvbi91dGlsc1wiO1xuaW1wb3J0IHsgc2VuZFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvc2VuZC1yZXNwb25zZVwiO1xuaW1wb3J0IHsgZnJvbU5vZGVPdXRnb2luZ0h0dHBIZWFkZXJzLCB0b05vZGVPdXRnb2luZ0h0dHBIZWFkZXJzIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvd2ViL3V0aWxzXCI7XG5pbXBvcnQgeyBnZXRDYWNoZUNvbnRyb2xIZWFkZXIgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvY2FjaGUtY29udHJvbFwiO1xuaW1wb3J0IHsgSU5GSU5JVEVfQ0FDSEUsIE5FWFRfQ0FDSEVfVEFHU19IRUFERVIgfSBmcm9tIFwibmV4dC9kaXN0L2xpYi9jb25zdGFudHNcIjtcbmltcG9ydCB7IE5vRmFsbGJhY2tFcnJvciB9IGZyb20gXCJuZXh0L2Rpc3Qvc2hhcmVkL2xpYi9uby1mYWxsYmFjay1lcnJvci5leHRlcm5hbFwiO1xuaW1wb3J0IHsgQ2FjaGVkUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcmVzcG9uc2UtY2FjaGVcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxwcm9qZWN0c1xcXFxiMmJzaXRlc1xcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxsaXN0aW5nc1xcXFxteVxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvbGlzdGluZ3MvbXkvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9saXN0aW5ncy9teVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvbGlzdGluZ3MvbXkvcm91dGVcIlxuICAgIH0sXG4gICAgZGlzdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX0RJU1RfRElSIHx8ICcnLFxuICAgIHJlbGF0aXZlUHJvamVjdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX1BST0pFQ1RfRElSIHx8ICcnLFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxccHJvamVjdHNcXFxcYjJic2l0ZXNcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcbGlzdGluZ3NcXFxcbXlcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICB3b3JrQXN5bmNTdG9yYWdlLFxuICAgICAgICB3b3JrVW5pdEFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgcGF0Y2hGZXRjaCwgIH07XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcywgY3R4KSB7XG4gICAgdmFyIF9uZXh0Q29uZmlnX2V4cGVyaW1lbnRhbDtcbiAgICBsZXQgc3JjUGFnZSA9IFwiL2FwaS9saXN0aW5ncy9teS9yb3V0ZVwiO1xuICAgIC8vIHR1cmJvcGFjayBkb2Vzbid0IG5vcm1hbGl6ZSBgL2luZGV4YCBpbiB0aGUgcGFnZSBuYW1lXG4gICAgLy8gc28gd2UgbmVlZCB0byB0byBwcm9jZXNzIGR5bmFtaWMgcm91dGVzIHByb3Blcmx5XG4gICAgLy8gVE9ETzogZml4IHR1cmJvcGFjayBwcm92aWRpbmcgZGlmZmVyaW5nIHZhbHVlIGZyb20gd2VicGFja1xuICAgIGlmIChwcm9jZXNzLmVudi5UVVJCT1BBQ0spIHtcbiAgICAgICAgc3JjUGFnZSA9IHNyY1BhZ2UucmVwbGFjZSgvXFwvaW5kZXgkLywgJycpIHx8ICcvJztcbiAgICB9IGVsc2UgaWYgKHNyY1BhZ2UgPT09ICcvaW5kZXgnKSB7XG4gICAgICAgIC8vIHdlIGFsd2F5cyBub3JtYWxpemUgL2luZGV4IHNwZWNpZmljYWxseVxuICAgICAgICBzcmNQYWdlID0gJy8nO1xuICAgIH1cbiAgICBjb25zdCBtdWx0aVpvbmVEcmFmdE1vZGUgPSBwcm9jZXNzLmVudi5fX05FWFRfTVVMVElfWk9ORV9EUkFGVF9NT0RFO1xuICAgIGNvbnN0IHByZXBhcmVSZXN1bHQgPSBhd2FpdCByb3V0ZU1vZHVsZS5wcmVwYXJlKHJlcSwgcmVzLCB7XG4gICAgICAgIHNyY1BhZ2UsXG4gICAgICAgIG11bHRpWm9uZURyYWZ0TW9kZVxuICAgIH0pO1xuICAgIGlmICghcHJlcGFyZVJlc3VsdCkge1xuICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwMDtcbiAgICAgICAgcmVzLmVuZCgnQmFkIFJlcXVlc3QnKTtcbiAgICAgICAgY3R4LndhaXRVbnRpbCA9PSBudWxsID8gdm9pZCAwIDogY3R4LndhaXRVbnRpbC5jYWxsKGN0eCwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgeyBidWlsZElkLCBwYXJhbXMsIG5leHRDb25maWcsIGlzRHJhZnRNb2RlLCBwcmVyZW5kZXJNYW5pZmVzdCwgcm91dGVyU2VydmVyQ29udGV4dCwgaXNPbkRlbWFuZFJldmFsaWRhdGUsIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkLCByZXNvbHZlZFBhdGhuYW1lIH0gPSBwcmVwYXJlUmVzdWx0O1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRTcmNQYWdlID0gbm9ybWFsaXplQXBwUGF0aChzcmNQYWdlKTtcbiAgICBsZXQgaXNJc3IgPSBCb29sZWFuKHByZXJlbmRlck1hbmlmZXN0LmR5bmFtaWNSb3V0ZXNbbm9ybWFsaXplZFNyY1BhZ2VdIHx8IHByZXJlbmRlck1hbmlmZXN0LnJvdXRlc1tyZXNvbHZlZFBhdGhuYW1lXSk7XG4gICAgaWYgKGlzSXNyICYmICFpc0RyYWZ0TW9kZSkge1xuICAgICAgICBjb25zdCBpc1ByZXJlbmRlcmVkID0gQm9vbGVhbihwcmVyZW5kZXJNYW5pZmVzdC5yb3V0ZXNbcmVzb2x2ZWRQYXRobmFtZV0pO1xuICAgICAgICBjb25zdCBwcmVyZW5kZXJJbmZvID0gcHJlcmVuZGVyTWFuaWZlc3QuZHluYW1pY1JvdXRlc1tub3JtYWxpemVkU3JjUGFnZV07XG4gICAgICAgIGlmIChwcmVyZW5kZXJJbmZvKSB7XG4gICAgICAgICAgICBpZiAocHJlcmVuZGVySW5mby5mYWxsYmFjayA9PT0gZmFsc2UgJiYgIWlzUHJlcmVuZGVyZWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm9GYWxsYmFja0Vycm9yKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgbGV0IGNhY2hlS2V5ID0gbnVsbDtcbiAgICBpZiAoaXNJc3IgJiYgIXJvdXRlTW9kdWxlLmlzRGV2ICYmICFpc0RyYWZ0TW9kZSkge1xuICAgICAgICBjYWNoZUtleSA9IHJlc29sdmVkUGF0aG5hbWU7XG4gICAgICAgIC8vIGVuc3VyZSAvaW5kZXggYW5kIC8gaXMgbm9ybWFsaXplZCB0byBvbmUga2V5XG4gICAgICAgIGNhY2hlS2V5ID0gY2FjaGVLZXkgPT09ICcvaW5kZXgnID8gJy8nIDogY2FjaGVLZXk7XG4gICAgfVxuICAgIGNvbnN0IHN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlID0gLy8gSWYgd2UncmUgaW4gZGV2ZWxvcG1lbnQsIHdlIGFsd2F5cyBzdXBwb3J0IGR5bmFtaWMgSFRNTFxuICAgIHJvdXRlTW9kdWxlLmlzRGV2ID09PSB0cnVlIHx8IC8vIElmIHRoaXMgaXMgbm90IFNTRyBvciBkb2VzIG5vdCBoYXZlIHN0YXRpYyBwYXRocywgdGhlbiBpdCBzdXBwb3J0c1xuICAgIC8vIGR5bmFtaWMgSFRNTC5cbiAgICAhaXNJc3I7XG4gICAgLy8gVGhpcyBpcyBhIHJldmFsaWRhdGlvbiByZXF1ZXN0IGlmIHRoZSByZXF1ZXN0IGlzIGZvciBhIHN0YXRpY1xuICAgIC8vIHBhZ2UgYW5kIGl0IGlzIG5vdCBiZWluZyByZXN1bWVkIGZyb20gYSBwb3N0cG9uZWQgcmVuZGVyIGFuZFxuICAgIC8vIGl0IGlzIG5vdCBhIGR5bmFtaWMgUlNDIHJlcXVlc3QgdGhlbiBpdCBpcyBhIHJldmFsaWRhdGlvblxuICAgIC8vIHJlcXVlc3QuXG4gICAgY29uc3QgaXNSZXZhbGlkYXRlID0gaXNJc3IgJiYgIXN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlO1xuICAgIGNvbnN0IG1ldGhvZCA9IHJlcS5tZXRob2QgfHwgJ0dFVCc7XG4gICAgY29uc3QgdHJhY2VyID0gZ2V0VHJhY2VyKCk7XG4gICAgY29uc3QgYWN0aXZlU3BhbiA9IHRyYWNlci5nZXRBY3RpdmVTY29wZVNwYW4oKTtcbiAgICBjb25zdCBjb250ZXh0ID0ge1xuICAgICAgICBwYXJhbXMsXG4gICAgICAgIHByZXJlbmRlck1hbmlmZXN0LFxuICAgICAgICByZW5kZXJPcHRzOiB7XG4gICAgICAgICAgICBleHBlcmltZW50YWw6IHtcbiAgICAgICAgICAgICAgICBjYWNoZUNvbXBvbmVudHM6IEJvb2xlYW4obmV4dENvbmZpZy5leHBlcmltZW50YWwuY2FjaGVDb21wb25lbnRzKSxcbiAgICAgICAgICAgICAgICBhdXRoSW50ZXJydXB0czogQm9vbGVhbihuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbC5hdXRoSW50ZXJydXB0cylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdXBwb3J0c0R5bmFtaWNSZXNwb25zZSxcbiAgICAgICAgICAgIGluY3JlbWVudGFsQ2FjaGU6IGdldFJlcXVlc3RNZXRhKHJlcSwgJ2luY3JlbWVudGFsQ2FjaGUnKSxcbiAgICAgICAgICAgIGNhY2hlTGlmZVByb2ZpbGVzOiAoX25leHRDb25maWdfZXhwZXJpbWVudGFsID0gbmV4dENvbmZpZy5leHBlcmltZW50YWwpID09IG51bGwgPyB2b2lkIDAgOiBfbmV4dENvbmZpZ19leHBlcmltZW50YWwuY2FjaGVMaWZlLFxuICAgICAgICAgICAgaXNSZXZhbGlkYXRlLFxuICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsLFxuICAgICAgICAgICAgb25DbG9zZTogKGNiKT0+e1xuICAgICAgICAgICAgICAgIHJlcy5vbignY2xvc2UnLCBjYik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25BZnRlclRhc2tFcnJvcjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgb25JbnN0cnVtZW50YXRpb25SZXF1ZXN0RXJyb3I6IChlcnJvciwgX3JlcXVlc3QsIGVycm9yQ29udGV4dCk9PnJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyb3IsIGVycm9yQ29udGV4dCwgcm91dGVyU2VydmVyQ29udGV4dClcbiAgICAgICAgfSxcbiAgICAgICAgc2hhcmVkQ29udGV4dDoge1xuICAgICAgICAgICAgYnVpbGRJZFxuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBub2RlTmV4dFJlcSA9IG5ldyBOb2RlTmV4dFJlcXVlc3QocmVxKTtcbiAgICBjb25zdCBub2RlTmV4dFJlcyA9IG5ldyBOb2RlTmV4dFJlc3BvbnNlKHJlcyk7XG4gICAgY29uc3QgbmV4dFJlcSA9IE5leHRSZXF1ZXN0QWRhcHRlci5mcm9tTm9kZU5leHRSZXF1ZXN0KG5vZGVOZXh0UmVxLCBzaWduYWxGcm9tTm9kZVJlc3BvbnNlKHJlcykpO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGludm9rZVJvdXRlTW9kdWxlID0gYXN5bmMgKHNwYW4pPT57XG4gICAgICAgICAgICByZXR1cm4gcm91dGVNb2R1bGUuaGFuZGxlKG5leHRSZXEsIGNvbnRleHQpLmZpbmFsbHkoKCk9PntcbiAgICAgICAgICAgICAgICBpZiAoIXNwYW4pIHJldHVybjtcbiAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAnaHR0cC5zdGF0dXNfY29kZSc6IHJlcy5zdGF0dXNDb2RlLFxuICAgICAgICAgICAgICAgICAgICAnbmV4dC5yc2MnOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJvb3RTcGFuQXR0cmlidXRlcyA9IHRyYWNlci5nZXRSb290U3BhbkF0dHJpYnV0ZXMoKTtcbiAgICAgICAgICAgICAgICAvLyBXZSB3ZXJlIHVuYWJsZSB0byBnZXQgYXR0cmlidXRlcywgcHJvYmFibHkgT1RFTCBpcyBub3QgZW5hYmxlZFxuICAgICAgICAgICAgICAgIGlmICghcm9vdFNwYW5BdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJykgIT09IEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBVbmV4cGVjdGVkIHJvb3Qgc3BhbiB0eXBlICcke3Jvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJyl9Jy4gUGxlYXNlIHJlcG9ydCB0aGlzIE5leHQuanMgaXNzdWUgaHR0cHM6Ly9naXRodWIuY29tL3ZlcmNlbC9uZXh0LmpzYCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3Qgcm91dGUgPSByb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnJvdXRlJyk7XG4gICAgICAgICAgICAgICAgaWYgKHJvdXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBgJHttZXRob2R9ICR7cm91dGV9YDtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQuc3Bhbl9uYW1lJzogbmFtZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKG5hbWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShgJHttZXRob2R9ICR7cmVxLnVybH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgaGFuZGxlUmVzcG9uc2UgPSBhc3luYyAoY3VycmVudFNwYW4pPT57XG4gICAgICAgICAgICB2YXIgX2NhY2hlRW50cnlfdmFsdWU7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZUdlbmVyYXRvciA9IGFzeW5jICh7IHByZXZpb3VzQ2FjaGVFbnRyeSB9KT0+e1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZ2V0UmVxdWVzdE1ldGEocmVxLCAnbWluaW1hbE1vZGUnKSAmJiBpc09uRGVtYW5kUmV2YWxpZGF0ZSAmJiByZXZhbGlkYXRlT25seUdlbmVyYXRlZCAmJiAhcHJldmlvdXNDYWNoZUVudHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwNDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uLWRlbWFuZCByZXZhbGlkYXRlIGFsd2F5cyBzZXRzIHRoaXMgaGVhZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCd4LW5leHRqcy1jYWNoZScsICdSRVZBTElEQVRFRCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLmVuZCgnVGhpcyBwYWdlIGNvdWxkIG5vdCBiZSBmb3VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBpbnZva2VSb3V0ZU1vZHVsZShjdXJyZW50U3Bhbik7XG4gICAgICAgICAgICAgICAgICAgIHJlcS5mZXRjaE1ldHJpY3MgPSBjb250ZXh0LnJlbmRlck9wdHMuZmV0Y2hNZXRyaWNzO1xuICAgICAgICAgICAgICAgICAgICBsZXQgcGVuZGluZ1dhaXRVbnRpbCA9IGNvbnRleHQucmVuZGVyT3B0cy5wZW5kaW5nV2FpdFVudGlsO1xuICAgICAgICAgICAgICAgICAgICAvLyBBdHRlbXB0IHVzaW5nIHByb3ZpZGVkIHdhaXRVbnRpbCBpZiBhdmFpbGFibGVcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXQncyBub3Qgd2UgZmFsbGJhY2sgdG8gc2VuZFJlc3BvbnNlJ3MgaGFuZGxpbmdcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdXYWl0VW50aWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdHgud2FpdFVudGlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LndhaXRVbnRpbChwZW5kaW5nV2FpdFVudGlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZW5kaW5nV2FpdFVudGlsID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlVGFncyA9IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRUYWdzO1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcmVxdWVzdCBpcyBmb3IgYSBzdGF0aWMgcmVzcG9uc2UsIHdlIGNhbiBjYWNoZSBpdCBzbyBsb25nXG4gICAgICAgICAgICAgICAgICAgIC8vIGFzIGl0J3Mgbm90IGVkZ2UuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0lzcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IHJlc3BvbnNlLmJsb2IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvcHkgdGhlIGhlYWRlcnMgZnJvbSB0aGUgcmVzcG9uc2UuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gdG9Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyhyZXNwb25zZS5oZWFkZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYWNoZVRhZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzW05FWFRfQ0FDSEVfVEFHU19IRUFERVJdID0gY2FjaGVUYWdzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoZWFkZXJzWydjb250ZW50LXR5cGUnXSAmJiBibG9iLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzWydjb250ZW50LXR5cGUnXSA9IGJsb2IudHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJldmFsaWRhdGUgPSB0eXBlb2YgY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFJldmFsaWRhdGUgPT09ICd1bmRlZmluZWQnIHx8IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRSZXZhbGlkYXRlID49IElORklOSVRFX0NBQ0hFID8gZmFsc2UgOiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkUmV2YWxpZGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4cGlyZSA9IHR5cGVvZiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID09PSAndW5kZWZpbmVkJyB8fCBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID49IElORklOSVRFX0NBQ0hFID8gdW5kZWZpbmVkIDogY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZEV4cGlyZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgY2FjaGUgZW50cnkgZm9yIHRoZSByZXNwb25zZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlRW50cnkgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2luZDogQ2FjaGVkUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IEJ1ZmZlci5mcm9tKGF3YWl0IGJsb2IuYXJyYXlCdWZmZXIoKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlQ29udHJvbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBpcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlRW50cnk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZW5kIHJlc3BvbnNlIHdpdGhvdXQgY2FjaGluZyBpZiBub3QgSVNSXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzZW5kUmVzcG9uc2Uobm9kZU5leHRSZXEsIG5vZGVOZXh0UmVzLCByZXNwb25zZSwgY29udGV4dC5yZW5kZXJPcHRzLnBlbmRpbmdXYWl0VW50aWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhIGJhY2tncm91bmQgcmV2YWxpZGF0ZSB3ZSBuZWVkIHRvIHJlcG9ydFxuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgcmVxdWVzdCBlcnJvciBoZXJlIGFzIGl0IHdvbid0IGJlIGJ1YmJsZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzQ2FjaGVFbnRyeSA9PSBudWxsID8gdm9pZCAwIDogcHJldmlvdXNDYWNoZUVudHJ5LmlzU3RhbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91dGVyS2luZDogJ0FwcCBSb3V0ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlUGF0aDogc3JjUGFnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2YWxpZGF0ZVJlYXNvbjogZ2V0UmV2YWxpZGF0ZVJlYXNvbih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgcm91dGVyU2VydmVyQ29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb25zdCBjYWNoZUVudHJ5ID0gYXdhaXQgcm91dGVNb2R1bGUuaGFuZGxlUmVzcG9uc2Uoe1xuICAgICAgICAgICAgICAgIHJlcSxcbiAgICAgICAgICAgICAgICBuZXh0Q29uZmlnLFxuICAgICAgICAgICAgICAgIGNhY2hlS2V5LFxuICAgICAgICAgICAgICAgIHJvdXRlS2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgICAgICAgICBpc0ZhbGxiYWNrOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBwcmVyZW5kZXJNYW5pZmVzdCxcbiAgICAgICAgICAgICAgICBpc1JvdXRlUFBSRW5hYmxlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgcmV2YWxpZGF0ZU9ubHlHZW5lcmF0ZWQsXG4gICAgICAgICAgICAgICAgcmVzcG9uc2VHZW5lcmF0b3IsXG4gICAgICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIHdlIGRvbid0IGNyZWF0ZSBhIGNhY2hlRW50cnkgZm9yIElTUlxuICAgICAgICAgICAgaWYgKCFpc0lzcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKChjYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiAoX2NhY2hlRW50cnlfdmFsdWUgPSBjYWNoZUVudHJ5LnZhbHVlKSA9PSBudWxsID8gdm9pZCAwIDogX2NhY2hlRW50cnlfdmFsdWUua2luZCkgIT09IENhY2hlZFJvdXRlS2luZC5BUFBfUk9VVEUpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NhY2hlRW50cnlfdmFsdWUxO1xuICAgICAgICAgICAgICAgIHRocm93IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXcgRXJyb3IoYEludmFyaWFudDogYXBwLXJvdXRlIHJlY2VpdmVkIGludmFsaWQgY2FjaGUgZW50cnkgJHtjYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiAoX2NhY2hlRW50cnlfdmFsdWUxID0gY2FjaGVFbnRyeS52YWx1ZSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9jYWNoZUVudHJ5X3ZhbHVlMS5raW5kfWApLCBcIl9fTkVYVF9FUlJPUl9DT0RFXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFwiRTcwMVwiLFxuICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWdldFJlcXVlc3RNZXRhKHJlcSwgJ21pbmltYWxNb2RlJykpIHtcbiAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCd4LW5leHRqcy1jYWNoZScsIGlzT25EZW1hbmRSZXZhbGlkYXRlID8gJ1JFVkFMSURBVEVEJyA6IGNhY2hlRW50cnkuaXNNaXNzID8gJ01JU1MnIDogY2FjaGVFbnRyeS5pc1N0YWxlID8gJ1NUQUxFJyA6ICdISVQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIERyYWZ0IG1vZGUgc2hvdWxkIG5ldmVyIGJlIGNhY2hlZFxuICAgICAgICAgICAgaWYgKGlzRHJhZnRNb2RlKSB7XG4gICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcignQ2FjaGUtQ29udHJvbCcsICdwcml2YXRlLCBuby1jYWNoZSwgbm8tc3RvcmUsIG1heC1hZ2U9MCwgbXVzdC1yZXZhbGlkYXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gZnJvbU5vZGVPdXRnb2luZ0h0dHBIZWFkZXJzKGNhY2hlRW50cnkudmFsdWUuaGVhZGVycyk7XG4gICAgICAgICAgICBpZiAoIShnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpICYmIGlzSXNyKSkge1xuICAgICAgICAgICAgICAgIGhlYWRlcnMuZGVsZXRlKE5FWFRfQ0FDSEVfVEFHU19IRUFERVIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gSWYgY2FjaGUgY29udHJvbCBpcyBhbHJlYWR5IHNldCBvbiB0aGUgcmVzcG9uc2Ugd2UgZG9uJ3RcbiAgICAgICAgICAgIC8vIG92ZXJyaWRlIGl0IHRvIGFsbG93IHVzZXJzIHRvIGN1c3RvbWl6ZSBpdCB2aWEgbmV4dC5jb25maWdcbiAgICAgICAgICAgIGlmIChjYWNoZUVudHJ5LmNhY2hlQ29udHJvbCAmJiAhcmVzLmdldEhlYWRlcignQ2FjaGUtQ29udHJvbCcpICYmICFoZWFkZXJzLmdldCgnQ2FjaGUtQ29udHJvbCcpKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVycy5zZXQoJ0NhY2hlLUNvbnRyb2wnLCBnZXRDYWNoZUNvbnRyb2xIZWFkZXIoY2FjaGVFbnRyeS5jYWNoZUNvbnRyb2wpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShjYWNoZUVudHJ5LnZhbHVlLmJvZHksIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgICAgIHN0YXR1czogY2FjaGVFbnRyeS52YWx1ZS5zdGF0dXMgfHwgMjAwXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgLy8gVE9ETzogYWN0aXZlU3BhbiBjb2RlIHBhdGggaXMgZm9yIHdoZW4gd3JhcHBlZCBieVxuICAgICAgICAvLyBuZXh0LXNlcnZlciBjYW4gYmUgcmVtb3ZlZCB3aGVuIHRoaXMgaXMgbm8gbG9uZ2VyIHVzZWRcbiAgICAgICAgaWYgKGFjdGl2ZVNwYW4pIHtcbiAgICAgICAgICAgIGF3YWl0IGhhbmRsZVJlc3BvbnNlKGFjdGl2ZVNwYW4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdHJhY2VyLndpdGhQcm9wYWdhdGVkQ29udGV4dChyZXEuaGVhZGVycywgKCk9PnRyYWNlci50cmFjZShCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0LCB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW5OYW1lOiBgJHttZXRob2R9ICR7cmVxLnVybH1gLFxuICAgICAgICAgICAgICAgICAgICBraW5kOiBTcGFuS2luZC5TRVJWRVIsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLm1ldGhvZCc6IG1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnRhcmdldCc6IHJlcS51cmxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGhhbmRsZVJlc3BvbnNlKSk7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgaWYgKCEoZXJyIGluc3RhbmNlb2YgTm9GYWxsYmFja0Vycm9yKSkge1xuICAgICAgICAgICAgYXdhaXQgcm91dGVNb2R1bGUub25SZXF1ZXN0RXJyb3IocmVxLCBlcnIsIHtcbiAgICAgICAgICAgICAgICByb3V0ZXJLaW5kOiAnQXBwIFJvdXRlcicsXG4gICAgICAgICAgICAgICAgcm91dGVQYXRoOiBub3JtYWxpemVkU3JjUGFnZSxcbiAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXG4gICAgICAgICAgICAgICAgcmV2YWxpZGF0ZVJlYXNvbjogZ2V0UmV2YWxpZGF0ZVJlYXNvbih7XG4gICAgICAgICAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gcmV0aHJvdyBzbyB0aGF0IHdlIGNhbiBoYW5kbGUgc2VydmluZyBlcnJvciBwYWdlXG4gICAgICAgIC8vIElmIHRoaXMgaXMgZHVyaW5nIHN0YXRpYyBnZW5lcmF0aW9uLCB0aHJvdyB0aGUgZXJyb3IgYWdhaW4uXG4gICAgICAgIGlmIChpc0lzcikgdGhyb3cgZXJyO1xuICAgICAgICAvLyBPdGhlcndpc2UsIHNlbmQgYSA1MDAgcmVzcG9uc2UuXG4gICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShudWxsLCB7XG4gICAgICAgICAgICBzdGF0dXM6IDUwMFxuICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Flistings%2Fmy%2Froute&page=%2Fapi%2Flistings%2Fmy%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Flistings%2Fmy%2Froute.ts&appDir=C%3A%5Cprojects%5Cb2bsites%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cprojects%5Cb2bsites&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/listings/my/route.ts":
/*!******************************************!*\
  !*** ./src/app/api/listings/my/route.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_auth_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/auth-server */ \"(rsc)/./src/lib/auth-server.ts\");\n/* harmony import */ var _server_services_listing_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/server/services/listing.service */ \"(rsc)/./src/server/services/listing.service.ts\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n/**\r\n * GET /api/listings/my  List current hospital's listings with filters (ADMIN only).\r\n * Query: title, category, status, page, pageSize\r\n */ \n\n\n\nconst querySchema = zod__WEBPACK_IMPORTED_MODULE_3__.object({\n    title: zod__WEBPACK_IMPORTED_MODULE_3__.string().optional(),\n    category: zod__WEBPACK_IMPORTED_MODULE_3__.string().optional(),\n    status: zod__WEBPACK_IMPORTED_MODULE_3__[\"enum\"]([\n        'ACTIVE',\n        'SOLD_OUT',\n        'EXPIRED',\n        'INACTIVE'\n    ]).optional(),\n    page: zod__WEBPACK_IMPORTED_MODULE_3__.coerce.number().int().min(1).optional(),\n    pageSize: zod__WEBPACK_IMPORTED_MODULE_3__.coerce.number().int().min(1).max(100).optional()\n});\nasync function GET(request) {\n    const auth = await (0,_lib_auth_server__WEBPACK_IMPORTED_MODULE_1__.requireRole)([\n        'ADMIN'\n    ], request);\n    if ('error' in auth) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: auth.error\n        }, {\n            status: auth.status\n        });\n    }\n    if (!auth.user.organizationId) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Organization not found'\n        }, {\n            status: 404\n        });\n    }\n    const { searchParams } = new URL(request.url);\n    const parsed = querySchema.safeParse({\n        title: searchParams.get('title') ?? undefined,\n        category: searchParams.get('category') ?? undefined,\n        status: searchParams.get('status') ?? undefined,\n        page: searchParams.get('page') ?? undefined,\n        pageSize: searchParams.get('pageSize') ?? undefined\n    });\n    if (!parsed.success) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Invalid query',\n            details: parsed.error.flatten()\n        }, {\n            status: 400\n        });\n    }\n    const result = await _server_services_listing_service__WEBPACK_IMPORTED_MODULE_2__.listingService.getMyListings({\n        hospitalId: auth.user.organizationId,\n        ...parsed.data\n    });\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9saXN0aW5ncy9teS9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBOzs7Q0FHQyxHQUV1RDtBQUNSO0FBQ21CO0FBQzNDO0FBRXhCLE1BQU1JLGNBQWNELHVDQUFRLENBQUM7SUFDM0JHLE9BQU9ILHVDQUFRLEdBQUdLLFFBQVE7SUFDMUJDLFVBQVVOLHVDQUFRLEdBQUdLLFFBQVE7SUFDN0JFLFFBQVFQLHdDQUFNLENBQUM7UUFBQztRQUFVO1FBQVk7UUFBVztLQUFXLEVBQUVLLFFBQVE7SUFDdEVJLE1BQU1ULHVDQUFRLENBQUNXLE1BQU0sR0FBR0MsR0FBRyxHQUFHQyxHQUFHLENBQUMsR0FBR1IsUUFBUTtJQUM3Q1MsVUFBVWQsdUNBQVEsQ0FBQ1csTUFBTSxHQUFHQyxHQUFHLEdBQUdDLEdBQUcsQ0FBQyxHQUFHRSxHQUFHLENBQUMsS0FBS1YsUUFBUTtBQUM1RDtBQUVPLGVBQWVXLElBQUlDLE9BQW9CO0lBQzVDLE1BQU1DLE9BQU8sTUFBTXBCLDZEQUFXQSxDQUFDO1FBQUM7S0FBUSxFQUFFbUI7SUFDMUMsSUFBSSxXQUFXQyxNQUFNO1FBQ25CLE9BQU9yQixxREFBWUEsQ0FBQ3NCLElBQUksQ0FBQztZQUFFQyxPQUFPRixLQUFLRSxLQUFLO1FBQUMsR0FBRztZQUFFYixRQUFRVyxLQUFLWCxNQUFNO1FBQUM7SUFDeEU7SUFDQSxJQUFJLENBQUNXLEtBQUtHLElBQUksQ0FBQ0MsY0FBYyxFQUFFO1FBQzdCLE9BQU96QixxREFBWUEsQ0FBQ3NCLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQXlCLEdBQUc7WUFBRWIsUUFBUTtRQUFJO0lBQzlFO0lBQ0EsTUFBTSxFQUFFZ0IsWUFBWSxFQUFFLEdBQUcsSUFBSUMsSUFBSVAsUUFBUVEsR0FBRztJQUM1QyxNQUFNQyxTQUFTekIsWUFBWTBCLFNBQVMsQ0FBQztRQUNuQ3hCLE9BQU9vQixhQUFhSyxHQUFHLENBQUMsWUFBWUM7UUFDcEN2QixVQUFVaUIsYUFBYUssR0FBRyxDQUFDLGVBQWVDO1FBQzFDdEIsUUFBUWdCLGFBQWFLLEdBQUcsQ0FBQyxhQUFhQztRQUN0Q3BCLE1BQU1jLGFBQWFLLEdBQUcsQ0FBQyxXQUFXQztRQUNsQ2YsVUFBVVMsYUFBYUssR0FBRyxDQUFDLGVBQWVDO0lBQzVDO0lBQ0EsSUFBSSxDQUFDSCxPQUFPSSxPQUFPLEVBQUU7UUFDbkIsT0FBT2pDLHFEQUFZQSxDQUFDc0IsSUFBSSxDQUFDO1lBQUVDLE9BQU87WUFBaUJXLFNBQVNMLE9BQU9OLEtBQUssQ0FBQ1ksT0FBTztRQUFHLEdBQUc7WUFBRXpCLFFBQVE7UUFBSTtJQUN0RztJQUNBLE1BQU0wQixTQUFTLE1BQU1sQyw0RUFBY0EsQ0FBQ21DLGFBQWEsQ0FBQztRQUNoREMsWUFBWWpCLEtBQUtHLElBQUksQ0FBQ0MsY0FBYztRQUNwQyxHQUFHSSxPQUFPVSxJQUFJO0lBQ2hCO0lBQ0EsT0FBT3ZDLHFEQUFZQSxDQUFDc0IsSUFBSSxDQUFDYztBQUMzQiIsInNvdXJjZXMiOlsiQzpcXHByb2plY3RzXFxiMmJzaXRlc1xcc3JjXFxhcHBcXGFwaVxcbGlzdGluZ3NcXG15XFxyb3V0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogR0VUIC9hcGkvbGlzdGluZ3MvbXkg4oCUIExpc3QgY3VycmVudCBob3NwaXRhbCdzIGxpc3RpbmdzIHdpdGggZmlsdGVycyAoQURNSU4gb25seSkuXHJcbiAqIFF1ZXJ5OiB0aXRsZSwgY2F0ZWdvcnksIHN0YXR1cywgcGFnZSwgcGFnZVNpemVcclxuICovXHJcblxyXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xyXG5pbXBvcnQgeyByZXF1aXJlUm9sZSB9IGZyb20gJ0AvbGliL2F1dGgtc2VydmVyJztcclxuaW1wb3J0IHsgbGlzdGluZ1NlcnZpY2UgfSBmcm9tICdAL3NlcnZlci9zZXJ2aWNlcy9saXN0aW5nLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcclxuXHJcbmNvbnN0IHF1ZXJ5U2NoZW1hID0gei5vYmplY3Qoe1xyXG4gIHRpdGxlOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXHJcbiAgY2F0ZWdvcnk6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcclxuICBzdGF0dXM6IHouZW51bShbJ0FDVElWRScsICdTT0xEX09VVCcsICdFWFBJUkVEJywgJ0lOQUNUSVZFJ10pLm9wdGlvbmFsKCksXHJcbiAgcGFnZTogei5jb2VyY2UubnVtYmVyKCkuaW50KCkubWluKDEpLm9wdGlvbmFsKCksXHJcbiAgcGFnZVNpemU6IHouY29lcmNlLm51bWJlcigpLmludCgpLm1pbigxKS5tYXgoMTAwKS5vcHRpb25hbCgpLFxyXG59KTtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICBjb25zdCBhdXRoID0gYXdhaXQgcmVxdWlyZVJvbGUoWydBRE1JTiddLCByZXF1ZXN0KTtcclxuICBpZiAoJ2Vycm9yJyBpbiBhdXRoKSB7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogYXV0aC5lcnJvciB9LCB7IHN0YXR1czogYXV0aC5zdGF0dXMgfSk7XHJcbiAgfVxyXG4gIGlmICghYXV0aC51c2VyLm9yZ2FuaXphdGlvbklkKSB7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ09yZ2FuaXphdGlvbiBub3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDQgfSk7XHJcbiAgfVxyXG4gIGNvbnN0IHsgc2VhcmNoUGFyYW1zIH0gPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcclxuICBjb25zdCBwYXJzZWQgPSBxdWVyeVNjaGVtYS5zYWZlUGFyc2Uoe1xyXG4gICAgdGl0bGU6IHNlYXJjaFBhcmFtcy5nZXQoJ3RpdGxlJykgPz8gdW5kZWZpbmVkLFxyXG4gICAgY2F0ZWdvcnk6IHNlYXJjaFBhcmFtcy5nZXQoJ2NhdGVnb3J5JykgPz8gdW5kZWZpbmVkLFxyXG4gICAgc3RhdHVzOiBzZWFyY2hQYXJhbXMuZ2V0KCdzdGF0dXMnKSA/PyB1bmRlZmluZWQsXHJcbiAgICBwYWdlOiBzZWFyY2hQYXJhbXMuZ2V0KCdwYWdlJykgPz8gdW5kZWZpbmVkLFxyXG4gICAgcGFnZVNpemU6IHNlYXJjaFBhcmFtcy5nZXQoJ3BhZ2VTaXplJykgPz8gdW5kZWZpbmVkLFxyXG4gIH0pO1xyXG4gIGlmICghcGFyc2VkLnN1Y2Nlc3MpIHtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnSW52YWxpZCBxdWVyeScsIGRldGFpbHM6IHBhcnNlZC5lcnJvci5mbGF0dGVuKCkgfSwgeyBzdGF0dXM6IDQwMCB9KTtcclxuICB9XHJcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbGlzdGluZ1NlcnZpY2UuZ2V0TXlMaXN0aW5ncyh7XHJcbiAgICBob3NwaXRhbElkOiBhdXRoLnVzZXIub3JnYW5pemF0aW9uSWQsXHJcbiAgICAuLi5wYXJzZWQuZGF0YSxcclxuICB9KTtcclxuICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVzdWx0KTtcclxufVxyXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwicmVxdWlyZVJvbGUiLCJsaXN0aW5nU2VydmljZSIsInoiLCJxdWVyeVNjaGVtYSIsIm9iamVjdCIsInRpdGxlIiwic3RyaW5nIiwib3B0aW9uYWwiLCJjYXRlZ29yeSIsInN0YXR1cyIsImVudW0iLCJwYWdlIiwiY29lcmNlIiwibnVtYmVyIiwiaW50IiwibWluIiwicGFnZVNpemUiLCJtYXgiLCJHRVQiLCJyZXF1ZXN0IiwiYXV0aCIsImpzb24iLCJlcnJvciIsInVzZXIiLCJvcmdhbml6YXRpb25JZCIsInNlYXJjaFBhcmFtcyIsIlVSTCIsInVybCIsInBhcnNlZCIsInNhZmVQYXJzZSIsImdldCIsInVuZGVmaW5lZCIsInN1Y2Nlc3MiLCJkZXRhaWxzIiwiZmxhdHRlbiIsInJlc3VsdCIsImdldE15TGlzdGluZ3MiLCJob3NwaXRhbElkIiwiZGF0YSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/listings/my/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth-server.ts":
/*!********************************!*\
  !*** ./src/lib/auth-server.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCurrentUser: () => (/* binding */ getCurrentUser),\n/* harmony export */   getSession: () => (/* binding */ getSession),\n/* harmony export */   requireAuth: () => (/* binding */ requireAuth),\n/* harmony export */   requireRole: () => (/* binding */ requireRole)\n/* harmony export */ });\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./src/lib/auth.ts\");\n/**\r\n * Server-side auth: get session and require auth/role for API routes.\r\n * In App Router, getServerSession(authOptions) uses the current request context for cookies.\r\n */ \n\n/**\r\n * Get session. In App Router, use getServerSession(authOptions) only  it reads\r\n * cookies from the current request context (Route Handler / Server Component).\r\n */ async function getSession(_request) {\n    try {\n        return await (0,next_auth__WEBPACK_IMPORTED_MODULE_0__.getServerSession)(_lib_auth__WEBPACK_IMPORTED_MODULE_1__.authOptions);\n    } catch  {\n        return null;\n    }\n}\n/** Get current user from session. Null if not logged in. */ async function getCurrentUser(request) {\n    const session = await getSession(request);\n    if (!session?.user?.id || !session.user.role) return null;\n    const role = session.user.role;\n    const organizationId = session.user.organizationId ?? null;\n    if (role !== 'SUPER_ADMIN' && !organizationId) return null;\n    return {\n        id: session.user.id,\n        organizationId,\n        role,\n        email: session.user.email ?? null\n    };\n}\n/** Require auth. Pass request in API Route Handlers so session cookie is read. */ async function requireAuth(request) {\n    const user = await getCurrentUser(request);\n    if (!user) return {\n        error: 'Unauthorized. Please sign in.',\n        status: 401\n    };\n    return {\n        user\n    };\n}\n/** Require auth and role. Pass request in API Route Handlers. */ async function requireRole(allowed, request) {\n    const auth = await requireAuth(request);\n    if ('error' in auth) return auth;\n    if (!allowed.includes(auth.user.role)) {\n        return {\n            error: `Forbidden: requires one of ${allowed.join(', ')}`,\n            status: 403\n        };\n    }\n    return {\n        user: auth.user\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2F1dGgtc2VydmVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQTs7O0NBR0MsR0FFNEM7QUFFSjtBQVN6Qzs7O0NBR0MsR0FDTSxlQUFlRSxXQUFXQyxRQUFrQjtJQUNqRCxJQUFJO1FBQ0YsT0FBTyxNQUFNSCwyREFBZ0JBLENBQUNDLGtEQUFXQTtJQUMzQyxFQUFFLE9BQU07UUFDTixPQUFPO0lBQ1Q7QUFDRjtBQUVBLDBEQUEwRCxHQUNuRCxlQUFlRyxlQUFlQyxPQUFpQjtJQUNwRCxNQUFNQyxVQUFVLE1BQU1KLFdBQVdHO0lBQ2pDLElBQUksQ0FBQ0MsU0FBU0MsTUFBTUMsTUFBTSxDQUFDRixRQUFRQyxJQUFJLENBQUNFLElBQUksRUFBRSxPQUFPO0lBQ3JELE1BQU1BLE9BQU9ILFFBQVFDLElBQUksQ0FBQ0UsSUFBSTtJQUM5QixNQUFNQyxpQkFBaUJKLFFBQVFDLElBQUksQ0FBQ0csY0FBYyxJQUFJO0lBQ3RELElBQUlELFNBQVMsaUJBQWlCLENBQUNDLGdCQUFnQixPQUFPO0lBQ3RELE9BQU87UUFDTEYsSUFBSUYsUUFBUUMsSUFBSSxDQUFDQyxFQUFFO1FBQ25CRTtRQUNBRDtRQUNBRSxPQUFPTCxRQUFRQyxJQUFJLENBQUNJLEtBQUssSUFBSTtJQUMvQjtBQUNGO0FBRUEsZ0ZBQWdGLEdBQ3pFLGVBQWVDLFlBQVlQLE9BQWlCO0lBR2pELE1BQU1FLE9BQU8sTUFBTUgsZUFBZUM7SUFDbEMsSUFBSSxDQUFDRSxNQUFNLE9BQU87UUFBRU0sT0FBTztRQUFpQ0MsUUFBUTtJQUFJO0lBQ3hFLE9BQU87UUFBRVA7SUFBSztBQUNoQjtBQUVBLCtEQUErRCxHQUN4RCxlQUFlUSxZQUFZQyxPQUFtQixFQUFFWCxPQUFpQjtJQUd0RSxNQUFNWSxPQUFPLE1BQU1MLFlBQVlQO0lBQy9CLElBQUksV0FBV1ksTUFBTSxPQUFPQTtJQUM1QixJQUFJLENBQUNELFFBQVFFLFFBQVEsQ0FBQ0QsS0FBS1YsSUFBSSxDQUFDRSxJQUFJLEdBQUc7UUFDckMsT0FBTztZQUFFSSxPQUFPLENBQUMsMkJBQTJCLEVBQUVHLFFBQVFHLElBQUksQ0FBQyxPQUFPO1lBQUVMLFFBQVE7UUFBSTtJQUNsRjtJQUNBLE9BQU87UUFBRVAsTUFBTVUsS0FBS1YsSUFBSTtJQUFDO0FBQzNCIiwic291cmNlcyI6WyJDOlxccHJvamVjdHNcXGIyYnNpdGVzXFxzcmNcXGxpYlxcYXV0aC1zZXJ2ZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIFNlcnZlci1zaWRlIGF1dGg6IGdldCBzZXNzaW9uIGFuZCByZXF1aXJlIGF1dGgvcm9sZSBmb3IgQVBJIHJvdXRlcy5cclxuICogSW4gQXBwIFJvdXRlciwgZ2V0U2VydmVyU2Vzc2lvbihhdXRoT3B0aW9ucykgdXNlcyB0aGUgY3VycmVudCByZXF1ZXN0IGNvbnRleHQgZm9yIGNvb2tpZXMuXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgZ2V0U2VydmVyU2Vzc2lvbiB9IGZyb20gJ25leHQtYXV0aCc7XHJcbmltcG9ydCB0eXBlIHsgVXNlclJvbGUgfSBmcm9tICdAcHJpc21hL2NsaWVudCc7XHJcbmltcG9ydCB7IGF1dGhPcHRpb25zIH0gZnJvbSAnQC9saWIvYXV0aCc7XHJcblxyXG5leHBvcnQgdHlwZSBDdXJyZW50VXNlciA9IHtcclxuICBpZDogc3RyaW5nO1xyXG4gIG9yZ2FuaXphdGlvbklkOiBzdHJpbmcgfCBudWxsOyAvLyBudWxsIGZvciBTVVBFUl9BRE1JTlxyXG4gIHJvbGU6IFVzZXJSb2xlO1xyXG4gIGVtYWlsPzogc3RyaW5nIHwgbnVsbDtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXQgc2Vzc2lvbi4gSW4gQXBwIFJvdXRlciwgdXNlIGdldFNlcnZlclNlc3Npb24oYXV0aE9wdGlvbnMpIG9ubHkg4oCUIGl0IHJlYWRzXHJcbiAqIGNvb2tpZXMgZnJvbSB0aGUgY3VycmVudCByZXF1ZXN0IGNvbnRleHQgKFJvdXRlIEhhbmRsZXIgLyBTZXJ2ZXIgQ29tcG9uZW50KS5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXNzaW9uKF9yZXF1ZXN0PzogUmVxdWVzdCkge1xyXG4gIHRyeSB7XHJcbiAgICByZXR1cm4gYXdhaXQgZ2V0U2VydmVyU2Vzc2lvbihhdXRoT3B0aW9ucyk7XHJcbiAgfSBjYXRjaCB7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbi8qKiBHZXQgY3VycmVudCB1c2VyIGZyb20gc2Vzc2lvbi4gTnVsbCBpZiBub3QgbG9nZ2VkIGluLiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q3VycmVudFVzZXIocmVxdWVzdD86IFJlcXVlc3QpOiBQcm9taXNlPEN1cnJlbnRVc2VyIHwgbnVsbD4ge1xyXG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uKHJlcXVlc3QpO1xyXG4gIGlmICghc2Vzc2lvbj8udXNlcj8uaWQgfHwgIXNlc3Npb24udXNlci5yb2xlKSByZXR1cm4gbnVsbDtcclxuICBjb25zdCByb2xlID0gc2Vzc2lvbi51c2VyLnJvbGUgYXMgVXNlclJvbGU7XHJcbiAgY29uc3Qgb3JnYW5pemF0aW9uSWQgPSBzZXNzaW9uLnVzZXIub3JnYW5pemF0aW9uSWQgPz8gbnVsbDtcclxuICBpZiAocm9sZSAhPT0gJ1NVUEVSX0FETUlOJyAmJiAhb3JnYW5pemF0aW9uSWQpIHJldHVybiBudWxsO1xyXG4gIHJldHVybiB7XHJcbiAgICBpZDogc2Vzc2lvbi51c2VyLmlkLFxyXG4gICAgb3JnYW5pemF0aW9uSWQsXHJcbiAgICByb2xlLFxyXG4gICAgZW1haWw6IHNlc3Npb24udXNlci5lbWFpbCA/PyBudWxsLFxyXG4gIH07XHJcbn1cclxuXHJcbi8qKiBSZXF1aXJlIGF1dGguIFBhc3MgcmVxdWVzdCBpbiBBUEkgUm91dGUgSGFuZGxlcnMgc28gc2Vzc2lvbiBjb29raWUgaXMgcmVhZC4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcXVpcmVBdXRoKHJlcXVlc3Q/OiBSZXF1ZXN0KTogUHJvbWlzZTxcclxuICB7IHVzZXI6IEN1cnJlbnRVc2VyIH0gfCB7IGVycm9yOiBzdHJpbmc7IHN0YXR1czogNDAxIH1cclxuPiB7XHJcbiAgY29uc3QgdXNlciA9IGF3YWl0IGdldEN1cnJlbnRVc2VyKHJlcXVlc3QpO1xyXG4gIGlmICghdXNlcikgcmV0dXJuIHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQuIFBsZWFzZSBzaWduIGluLicsIHN0YXR1czogNDAxIH07XHJcbiAgcmV0dXJuIHsgdXNlciB9O1xyXG59XHJcblxyXG4vKiogUmVxdWlyZSBhdXRoIGFuZCByb2xlLiBQYXNzIHJlcXVlc3QgaW4gQVBJIFJvdXRlIEhhbmRsZXJzLiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZVJvbGUoYWxsb3dlZDogVXNlclJvbGVbXSwgcmVxdWVzdD86IFJlcXVlc3QpOiBQcm9taXNlPFxyXG4gIHsgdXNlcjogQ3VycmVudFVzZXIgfSB8IHsgZXJyb3I6IHN0cmluZzsgc3RhdHVzOiA0MDEgfCA0MDMgfVxyXG4+IHtcclxuICBjb25zdCBhdXRoID0gYXdhaXQgcmVxdWlyZUF1dGgocmVxdWVzdCk7XHJcbiAgaWYgKCdlcnJvcicgaW4gYXV0aCkgcmV0dXJuIGF1dGg7XHJcbiAgaWYgKCFhbGxvd2VkLmluY2x1ZGVzKGF1dGgudXNlci5yb2xlKSkge1xyXG4gICAgcmV0dXJuIHsgZXJyb3I6IGBGb3JiaWRkZW46IHJlcXVpcmVzIG9uZSBvZiAke2FsbG93ZWQuam9pbignLCAnKX1gLCBzdGF0dXM6IDQwMyB9O1xyXG4gIH1cclxuICByZXR1cm4geyB1c2VyOiBhdXRoLnVzZXIgfTtcclxufVxyXG4iXSwibmFtZXMiOlsiZ2V0U2VydmVyU2Vzc2lvbiIsImF1dGhPcHRpb25zIiwiZ2V0U2Vzc2lvbiIsIl9yZXF1ZXN0IiwiZ2V0Q3VycmVudFVzZXIiLCJyZXF1ZXN0Iiwic2Vzc2lvbiIsInVzZXIiLCJpZCIsInJvbGUiLCJvcmdhbml6YXRpb25JZCIsImVtYWlsIiwicmVxdWlyZUF1dGgiLCJlcnJvciIsInN0YXR1cyIsInJlcXVpcmVSb2xlIiwiYWxsb3dlZCIsImF1dGgiLCJpbmNsdWRlcyIsImpvaW4iXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth-server.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authOptions: () => (/* binding */ authOptions)\n/* harmony export */ });\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/providers/credentials */ \"(rsc)/./node_modules/next-auth/providers/credentials.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/**\r\n * NextAuth config: Credentials provider + JWT session with id, organizationId, role.\r\n * For API auth, use getServerSession(authOptions) and requireSession().\r\n */ \n\n\nconst authOptions = {\n    providers: [\n        (0,next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n            name: 'Credentials',\n            credentials: {\n                email: {\n                    label: 'Email',\n                    type: 'email'\n                },\n                password: {\n                    label: 'Password',\n                    type: 'password'\n                }\n            },\n            async authorize (credentials) {\n                if (!credentials?.email || !credentials?.password) return null;\n                const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.user.findUnique({\n                    where: {\n                        email: credentials.email\n                    },\n                    include: {\n                        organization: true\n                    }\n                });\n                if (!user) return null;\n                const ok = await (0,bcryptjs__WEBPACK_IMPORTED_MODULE_1__.compare)(credentials.password, user.passwordHash);\n                if (!ok) return null;\n                // Super admin: no org; hospital users: must belong to an approved org\n                if (user.role === 'SUPER_ADMIN') {\n                    return {\n                        id: user.id,\n                        email: user.email,\n                        name: 'Platform Admin',\n                        role: user.role,\n                        organizationId: null\n                    };\n                }\n                if (!user.organizationId || !user.organization) return null;\n                if (user.organization.status !== 'APPROVED') return null; // Hospital not approved yet\n                return {\n                    id: user.id,\n                    email: user.email,\n                    name: user.organization.name,\n                    role: user.role,\n                    organizationId: user.organizationId\n                };\n            }\n        })\n    ],\n    session: {\n        strategy: 'jwt',\n        maxAge: 30 * 24 * 60 * 60,\n        updateAge: 24 * 60 * 60\n    },\n    cookies: {\n        sessionToken: {\n            name:  false ? 0 : 'next-auth.session-token',\n            options: {\n                httpOnly: true,\n                sameSite: 'lax',\n                path: '/',\n                secure: \"development\" === 'production',\n                maxAge: 30 * 24 * 60 * 60\n            }\n        }\n    },\n    callbacks: {\n        async jwt ({ token, user }) {\n            if (user) {\n                token.id = user.id;\n                token.organizationId = user.organizationId;\n                token.role = user.role;\n            }\n            return token;\n        },\n        async session ({ session, token }) {\n            if (session.user) {\n                session.user.id = token.id;\n                session.user.organizationId = token.organizationId;\n                session.user.role = token.role;\n            }\n            return session;\n        }\n    },\n    pages: {\n        signIn: '/login'\n    },\n    secret: process.env.AUTH_SECRET\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R0FBRyxDQUFDQyxXQUFXO0FBQ2pDLEVBQUUiLCJzb3VyY2VzIjpbIkM6XFxwcm9qZWN0c1xcYjJic2l0ZXNcXHNyY1xcbGliXFxhdXRoLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBOZXh0QXV0aCBjb25maWc6IENyZWRlbnRpYWxzIHByb3ZpZGVyICsgSldUIHNlc3Npb24gd2l0aCBpZCwgb3JnYW5pemF0aW9uSWQsIHJvbGUuXHJcbiAqIEZvciBBUEkgYXV0aCwgdXNlIGdldFNlcnZlclNlc3Npb24oYXV0aE9wdGlvbnMpIGFuZCByZXF1aXJlU2Vzc2lvbigpLlxyXG4gKi9cclxuXHJcbmltcG9ydCB0eXBlIHsgTmV4dEF1dGhPcHRpb25zIH0gZnJvbSAnbmV4dC1hdXRoJztcclxuaW1wb3J0IENyZWRlbnRpYWxzUHJvdmlkZXIgZnJvbSAnbmV4dC1hdXRoL3Byb3ZpZGVycy9jcmVkZW50aWFscyc7XHJcbmltcG9ydCB7IGNvbXBhcmUgfSBmcm9tICdiY3J5cHRqcyc7XHJcbmltcG9ydCB7IHByaXNtYSB9IGZyb20gJ0AvbGliL3ByaXNtYSc7XHJcblxyXG5leHBvcnQgY29uc3QgYXV0aE9wdGlvbnM6IE5leHRBdXRoT3B0aW9ucyA9IHtcclxuICBwcm92aWRlcnM6IFtcclxuICAgIENyZWRlbnRpYWxzUHJvdmlkZXIoe1xyXG4gICAgICBuYW1lOiAnQ3JlZGVudGlhbHMnLFxyXG4gICAgICBjcmVkZW50aWFsczoge1xyXG4gICAgICAgIGVtYWlsOiB7IGxhYmVsOiAnRW1haWwnLCB0eXBlOiAnZW1haWwnIH0sXHJcbiAgICAgICAgcGFzc3dvcmQ6IHsgbGFiZWw6ICdQYXNzd29yZCcsIHR5cGU6ICdwYXNzd29yZCcgfSxcclxuICAgICAgfSxcclxuICAgICAgYXN5bmMgYXV0aG9yaXplKGNyZWRlbnRpYWxzKSB7XHJcbiAgICAgICAgaWYgKCFjcmVkZW50aWFscz8uZW1haWwgfHwgIWNyZWRlbnRpYWxzPy5wYXNzd29yZCkgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgd2hlcmU6IHsgZW1haWw6IGNyZWRlbnRpYWxzLmVtYWlsIH0sXHJcbiAgICAgICAgICBpbmNsdWRlOiB7IG9yZ2FuaXphdGlvbjogdHJ1ZSB9LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICghdXNlcikgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgY29uc3Qgb2sgPSBhd2FpdCBjb21wYXJlKGNyZWRlbnRpYWxzLnBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkSGFzaCk7XHJcbiAgICAgICAgaWYgKCFvaykgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgLy8gU3VwZXIgYWRtaW46IG5vIG9yZzsgaG9zcGl0YWwgdXNlcnM6IG11c3QgYmVsb25nIHRvIGFuIGFwcHJvdmVkIG9yZ1xyXG4gICAgICAgIGlmICh1c2VyLnJvbGUgPT09ICdTVVBFUl9BRE1JTicpIHtcclxuICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGlkOiB1c2VyLmlkLFxyXG4gICAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcclxuICAgICAgICAgICAgbmFtZTogJ1BsYXRmb3JtIEFkbWluJyxcclxuICAgICAgICAgICAgcm9sZTogdXNlci5yb2xlLFxyXG4gICAgICAgICAgICBvcmdhbml6YXRpb25JZDogbnVsbCxcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdXNlci5vcmdhbml6YXRpb25JZCB8fCAhdXNlci5vcmdhbml6YXRpb24pIHJldHVybiBudWxsO1xyXG4gICAgICAgIGlmICh1c2VyLm9yZ2FuaXphdGlvbi5zdGF0dXMgIT09ICdBUFBST1ZFRCcpIHJldHVybiBudWxsOyAvLyBIb3NwaXRhbCBub3QgYXBwcm92ZWQgeWV0XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIGlkOiB1c2VyLmlkLFxyXG4gICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXHJcbiAgICAgICAgICBuYW1lOiB1c2VyLm9yZ2FuaXphdGlvbi5uYW1lLFxyXG4gICAgICAgICAgcm9sZTogdXNlci5yb2xlLFxyXG4gICAgICAgICAgb3JnYW5pemF0aW9uSWQ6IHVzZXIub3JnYW5pemF0aW9uSWQsXHJcbiAgICAgICAgfTtcclxuICAgICAgfSxcclxuICAgIH0pLFxyXG4gIF0sXHJcbiAgc2Vzc2lvbjoge1xyXG4gICAgc3RyYXRlZ3k6ICdqd3QnLFxyXG4gICAgbWF4QWdlOiAzMCAqIDI0ICogNjAgKiA2MCwgLy8gMzAgZGF5c1xyXG4gICAgdXBkYXRlQWdlOiAyNCAqIDYwICogNjAsICAgLy8gVXBkYXRlIHNlc3Npb24gaWYgb2xkZXIgdGhhbiAyNGggKGV4dGVuZHMgY29va2llKVxyXG4gIH0sXHJcbiAgY29va2llczoge1xyXG4gICAgc2Vzc2lvblRva2VuOiB7XHJcbiAgICAgIG5hbWU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgPyAnX19TZWN1cmUtbmV4dC1hdXRoLnNlc3Npb24tdG9rZW4nIDogJ25leHQtYXV0aC5zZXNzaW9uLXRva2VuJyxcclxuICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgIGh0dHBPbmx5OiB0cnVlLFxyXG4gICAgICAgIHNhbWVTaXRlOiAnbGF4JyxcclxuICAgICAgICBwYXRoOiAnLycsXHJcbiAgICAgICAgc2VjdXJlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nLFxyXG4gICAgICAgIG1heEFnZTogMzAgKiAyNCAqIDYwICogNjAsIC8vIDMwIGRheXMgaW4gc2Vjb25kcyDigJQgcHJldmVudHMgZWFybHkgbG9nb3V0XHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgY2FsbGJhY2tzOiB7XHJcbiAgICBhc3luYyBqd3QoeyB0b2tlbiwgdXNlciB9KSB7XHJcbiAgICAgIGlmICh1c2VyKSB7XHJcbiAgICAgICAgdG9rZW4uaWQgPSB1c2VyLmlkO1xyXG4gICAgICAgIHRva2VuLm9yZ2FuaXphdGlvbklkID0gKHVzZXIgYXMgeyBvcmdhbml6YXRpb25JZD86IHN0cmluZyB9KS5vcmdhbml6YXRpb25JZDtcclxuICAgICAgICB0b2tlbi5yb2xlID0gKHVzZXIgYXMgeyByb2xlPzogc3RyaW5nIH0pLnJvbGU7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHRva2VuO1xyXG4gICAgfSxcclxuICAgIGFzeW5jIHNlc3Npb24oeyBzZXNzaW9uLCB0b2tlbiB9KSB7XHJcbiAgICAgIGlmIChzZXNzaW9uLnVzZXIpIHtcclxuICAgICAgICAoc2Vzc2lvbi51c2VyIGFzIHsgaWQ/OiBzdHJpbmcgfSkuaWQgPSB0b2tlbi5pZCBhcyBzdHJpbmc7XHJcbiAgICAgICAgKHNlc3Npb24udXNlciBhcyB7IG9yZ2FuaXphdGlvbklkPzogc3RyaW5nIH0pLm9yZ2FuaXphdGlvbklkID0gdG9rZW4ub3JnYW5pemF0aW9uSWQgYXMgc3RyaW5nO1xyXG4gICAgICAgIChzZXNzaW9uLnVzZXIgYXMgeyByb2xlPzogc3RyaW5nIH0pLnJvbGUgPSB0b2tlbi5yb2xlIGFzIHN0cmluZztcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gc2Vzc2lvbjtcclxuICAgIH0sXHJcbiAgfSxcclxuICBwYWdlczoge1xyXG4gICAgc2lnbkluOiAnL2xvZ2luJyxcclxuICB9LFxyXG4gIHNlY3JldDogcHJvY2Vzcy5lbnYuQVVUSF9TRUNSRVQsXHJcbn07XHJcblxyXG5leHBvcnQgdHlwZSBTZXNzaW9uVXNlciA9IHtcclxuICBpZDogc3RyaW5nO1xyXG4gIGVtYWlsPzogc3RyaW5nIHwgbnVsbDtcclxuICBuYW1lPzogc3RyaW5nIHwgbnVsbDtcclxuICBvcmdhbml6YXRpb25JZDogc3RyaW5nO1xyXG4gIHJvbGU6IHN0cmluZztcclxufTtcclxuIl0sIm5hbWVzIjpbIkNyZWRlbnRpYWxzUHJvdmlkZXIiLCJjb21wYXJlIiwicHJpc21hIiwiYXV0aE9wdGlvbnMiLCJwcm92aWRlcnMiLCJuYW1lIiwiY3JlZGVudGlhbHMiLCJlbWFpbCIsImxhYmVsIiwidHlwZSIsInBhc3N3b3JkIiwiYXV0aG9yaXplIiwidXNlciIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsImluY2x1ZGUiLCJvcmdhbml6YXRpb24iLCJvayIsInBhc3N3b3JkSGFzaCIsInJvbGUiLCJpZCIsIm9yZ2FuaXphdGlvbklkIiwic3RhdHVzIiwic2Vzc2lvbiIsInN0cmF0ZWd5IiwibWF4QWdlIiwidXBkYXRlQWdlIiwiY29va2llcyIsInNlc3Npb25Ub2tlbiIsInByb2Nlc3MiLCJvcHRpb25zIiwiaHR0cE9ubHkiLCJzYW1lU2l0ZSIsInBhdGgiLCJzZWN1cmUiLCJjYWxsYmFja3MiLCJqd3QiLCJ0b2tlbiIsInBhZ2VzIiwic2lnbkluIiwic2VjcmV0IiwiZW52IiwiQVVUSF9TRUNSRVQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/**\r\n * Prisma client singleton for server-side use.\r\n * Prevents multiple instances in development (hot reload).\r\n */ \nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        'query',\n        'error',\n        'warn'\n    ] : 0\n});\nif (true) globalForPrisma.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7O0NBR0MsR0FDNkM7QUFFOUMsTUFBTUMsa0JBQWtCQztBQUVqQixNQUFNQyxTQUNYRixnQkFBZ0JFLE1BQU0sSUFDdEIsSUFBSUgsd0RBQVlBLENBQUM7SUFDZkksS0FBS0MsS0FBc0MsR0FBRztRQUFDO1FBQVM7UUFBUztLQUFPLEdBQUcsQ0FBUztBQUN0RixHQUFHO0FBRUwsSUFBSUEsSUFBcUMsRUFBRUosZ0JBQWdCRSxNQUFNLEdBQUdBIiwic291cmNlcyI6WyJDOlxccHJvamVjdHNcXGIyYnNpdGVzXFxzcmNcXGxpYlxccHJpc21hLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBQcmlzbWEgY2xpZW50IHNpbmdsZXRvbiBmb3Igc2VydmVyLXNpZGUgdXNlLlxyXG4gKiBQcmV2ZW50cyBtdWx0aXBsZSBpbnN0YW5jZXMgaW4gZGV2ZWxvcG1lbnQgKGhvdCByZWxvYWQpLlxyXG4gKi9cclxuaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xyXG5cclxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHsgcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWQgfTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcmlzbWEgPVxyXG4gIGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPz9cclxuICBuZXcgUHJpc21hQ2xpZW50KHtcclxuICAgIGxvZzogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBbJ3F1ZXJ5JywgJ2Vycm9yJywgJ3dhcm4nXSA6IFsnZXJyb3InXSxcclxuICB9KTtcclxuXHJcbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gcHJpc21hO1xyXG4iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwiZ2xvYmFsRm9yUHJpc21hIiwiZ2xvYmFsVGhpcyIsInByaXNtYSIsImxvZyIsInByb2Nlc3MiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/server/repositories/listing.repository.ts":
/*!*******************************************************!*\
  !*** ./src/server/repositories/listing.repository.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   listingRepository: () => (/* binding */ listingRepository)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/**\r\n * Listing repository: data access only. No business rules.\r\n * Used by listing.service for all DB reads/writes on listings.\r\n */ \n\nconst LISTING_STATUS_ACTIVE = 'ACTIVE';\nconst listingRepository = {\n    /**\r\n   * Search marketplace: only ACTIVE listings, optional filters, pagination.\r\n   * Caller should pass expiryAfter = new Date() to hide expired.\r\n   */ async findManySearch (params) {\n        const { category, priceMin, priceMax, hospitalId, excludeHospitalId, sort = 'latest', expiryAfter, page = 1, pageSize = 20 } = params;\n        const skip = (page - 1) * pageSize;\n        const where = {\n            status: LISTING_STATUS_ACTIVE\n        };\n        if (category) where.category = category;\n        if (excludeHospitalId) where.hospitalId = {\n            not: excludeHospitalId\n        };\n        else if (hospitalId) where.hospitalId = hospitalId;\n        if (priceMin != null || priceMax != null) {\n            where.pricePerUnit = {\n                ...priceMin != null && {\n                    gte: priceMin\n                },\n                ...priceMax != null && {\n                    lte: priceMax\n                }\n            };\n        }\n        if (expiryAfter != null) {\n            where.OR = [\n                {\n                    expiryDate: null\n                },\n                {\n                    expiryDate: {\n                        gte: expiryAfter\n                    }\n                }\n            ];\n        }\n        const orderBy = sort === 'price_asc' ? {\n            pricePerUnit: 'asc'\n        } : sort === 'price_desc' ? {\n            pricePerUnit: 'desc'\n        } : {\n            createdAt: 'desc'\n        };\n        const [items, total] = await Promise.all([\n            _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.listing.findMany({\n                where,\n                skip,\n                take: pageSize,\n                orderBy,\n                include: {\n                    hospital: {\n                        select: {\n                            id: true,\n                            name: true\n                        }\n                    }\n                }\n            }),\n            _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.listing.count({\n                where\n            })\n        ]);\n        return {\n            items,\n            total,\n            page,\n            pageSize\n        };\n    },\n    async findById (id) {\n        return _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.listing.findUnique({\n            where: {\n                id\n            },\n            include: {\n                hospital: {\n                    select: {\n                        id: true,\n                        name: true\n                    }\n                }\n            }\n        });\n    },\n    /** Listings by hospital (for seller dashboard) with optional filters. */ async findManyByHospital (params) {\n        const { hospitalId, title, category, status, page = 1, pageSize = 20 } = params;\n        const skip = (page - 1) * pageSize;\n        const where = {\n            hospitalId\n        };\n        if (title?.trim()) {\n            where.title = {\n                contains: title.trim(),\n                mode: 'insensitive'\n            };\n        }\n        if (category?.trim()) where.category = category.trim();\n        if (status) where.status = status;\n        const [items, total] = await Promise.all([\n            _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.listing.findMany({\n                where,\n                skip,\n                take: pageSize,\n                orderBy: {\n                    createdAt: 'desc'\n                },\n                include: {\n                    hospital: {\n                        select: {\n                            id: true,\n                            name: true\n                        }\n                    }\n                }\n            }),\n            _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.listing.count({\n                where\n            })\n        ]);\n        return {\n            items,\n            total,\n            page,\n            pageSize\n        };\n    },\n    /**\r\n   * Lock listing row for update (use inside transaction). Returns null if not found.\r\n   * Use with tx from prisma.$transaction(async (tx) => ...).\r\n   */ async findByIdForUpdate (tx, id) {\n        const rows = await tx.$queryRaw(_prisma_client__WEBPACK_IMPORTED_MODULE_0__.Prisma.sql`SELECT id, hospital_id, title, description, category, quantity_available, price_per_unit, expiry_date, status, created_at, updated_at FROM listings WHERE id = ${id} FOR UPDATE`);\n        if (rows.length === 0) return null;\n        const r = rows[0];\n        return {\n            id: r.id,\n            hospitalId: r.hospital_id,\n            title: r.title,\n            description: r.description,\n            category: r.category,\n            quantityAvailable: r.quantity_available,\n            pricePerUnit: r.price_per_unit,\n            expiryDate: r.expiry_date,\n            status: r.status,\n            createdAt: r.created_at,\n            updatedAt: r.updated_at\n        };\n    },\n    /**\r\n   * Atomic: set quantity_available and optionally status (e.g. SOLD_OUT when 0).\r\n   * Use inside transaction.\r\n   */ async updateQuantityAndStatus (tx, listingId, quantityAvailable, status) {\n        return tx.listing.update({\n            where: {\n                id: listingId\n            },\n            data: {\n                quantityAvailable,\n                status,\n                updatedAt: new Date()\n            }\n        });\n    },\n    async create (data) {\n        return _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.listing.create({\n            data\n        });\n    },\n    async update (id, data) {\n        return _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.listing.update({\n            where: {\n                id\n            },\n            data\n        });\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvc2VydmVyL3JlcG9zaXRvcmllcy9saXN0aW5nLnJlcG9zaXRvcnkudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOzs7Q0FHQyxHQUV1QztBQUNGO0FBR3RDLE1BQU1FLHdCQUF1QztBQXFDdEMsTUFBTUMsb0JBQW9CO0lBQy9COzs7R0FHQyxHQUNELE1BQU1DLGdCQUFlQyxNQUE0QjtRQUMvQyxNQUFNLEVBQUVDLFFBQVEsRUFBRUMsUUFBUSxFQUFFQyxRQUFRLEVBQUVDLFVBQVUsRUFBRUMsaUJBQWlCLEVBQUVDLE9BQU8sUUFBUSxFQUFFQyxXQUFXLEVBQUVDLE9BQU8sQ0FBQyxFQUFFQyxXQUFXLEVBQUUsRUFBRSxHQUFHVDtRQUMvSCxNQUFNVSxPQUFPLENBQUNGLE9BQU8sS0FBS0M7UUFFMUIsTUFBTUUsUUFBa0M7WUFDdENDLFFBQVFmO1FBQ1Y7UUFDQSxJQUFJSSxVQUFVVSxNQUFNVixRQUFRLEdBQUdBO1FBQy9CLElBQUlJLG1CQUFtQk0sTUFBTVAsVUFBVSxHQUFHO1lBQUVTLEtBQUtSO1FBQWtCO2FBQzlELElBQUlELFlBQVlPLE1BQU1QLFVBQVUsR0FBR0E7UUFDeEMsSUFBSUYsWUFBWSxRQUFRQyxZQUFZLE1BQU07WUFDeENRLE1BQU1HLFlBQVksR0FBRztnQkFDbkIsR0FBSVosWUFBWSxRQUFRO29CQUFFYSxLQUFLYjtnQkFBUyxDQUFDO2dCQUN6QyxHQUFJQyxZQUFZLFFBQVE7b0JBQUVhLEtBQUtiO2dCQUFTLENBQUM7WUFDM0M7UUFDRjtRQUNBLElBQUlJLGVBQWUsTUFBTTtZQUN2QkksTUFBTU0sRUFBRSxHQUFHO2dCQUNUO29CQUFFQyxZQUFZO2dCQUFLO2dCQUNuQjtvQkFBRUEsWUFBWTt3QkFBRUgsS0FBS1I7b0JBQVk7Z0JBQUU7YUFDcEM7UUFDSDtRQUVBLE1BQU1ZLFVBQ0piLFNBQVMsY0FBYztZQUFFUSxjQUFjO1FBQU0sSUFBSVIsU0FBUyxlQUFlO1lBQUVRLGNBQWM7UUFBTyxJQUFJO1lBQUVNLFdBQVc7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QTRCLEVBQzVCZ0IsU0FBaUIsRUFDakJSLGlCQUF5QixFQUN6QnRDLE1BQXFCO1FBRXJCLE9BQU84QixHQUFHakIsT0FBTyxDQUFDa0MsTUFBTSxDQUFDO1lBQ3ZCaEQsT0FBTztnQkFBRW9CLElBQUkyQjtZQUFVO1lBQ3ZCRSxNQUFNO2dCQUFFVjtnQkFBbUJ0QztnQkFBUTJDLFdBQVcsSUFBSU07WUFBTztRQUMzRDtJQUNGO0lBRUEsTUFBTUMsUUFBT0YsSUFBd0M7UUFDbkQsT0FBT2hFLCtDQUFNQSxDQUFDNkIsT0FBTyxDQUFDcUMsTUFBTSxDQUFDO1lBQUVGO1FBQUs7SUFDdEM7SUFFQSxNQUFNRCxRQUFPNUIsRUFBVSxFQUFFNkIsSUFBd0M7UUFDL0QsT0FBT2hFLCtDQUFNQSxDQUFDNkIsT0FBTyxDQUFDa0MsTUFBTSxDQUFDO1lBQUVoRCxPQUFPO2dCQUFFb0I7WUFBRztZQUFHNkI7UUFBSztJQUNyRDtBQUNGLEVBQUUiLCJzb3VyY2VzIjpbIkM6XFxwcm9qZWN0c1xcYjJic2l0ZXNcXHNyY1xcc2VydmVyXFxyZXBvc2l0b3JpZXNcXGxpc3RpbmcucmVwb3NpdG9yeS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogTGlzdGluZyByZXBvc2l0b3J5OiBkYXRhIGFjY2VzcyBvbmx5LiBObyBidXNpbmVzcyBydWxlcy5cclxuICogVXNlZCBieSBsaXN0aW5nLnNlcnZpY2UgZm9yIGFsbCBEQiByZWFkcy93cml0ZXMgb24gbGlzdGluZ3MuXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgUHJpc21hIH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xyXG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICdAL2xpYi9wcmlzbWEnO1xyXG5pbXBvcnQgdHlwZSB7IExpc3RpbmdTdGF0dXMgfSBmcm9tICdAcHJpc21hL2NsaWVudCc7XHJcblxyXG5jb25zdCBMSVNUSU5HX1NUQVRVU19BQ1RJVkU6IExpc3RpbmdTdGF0dXMgPSAnQUNUSVZFJztcclxuXHJcbmV4cG9ydCB0eXBlIFNlYXJjaExpc3RpbmdzUGFyYW1zID0ge1xyXG4gIGNhdGVnb3J5Pzogc3RyaW5nO1xyXG4gIHByaWNlTWluPzogbnVtYmVyO1xyXG4gIHByaWNlTWF4PzogbnVtYmVyO1xyXG4gIGhvc3BpdGFsSWQ/OiBzdHJpbmc7IC8vIEZpbHRlciBieSBzZWxsZXIgb3JnYW5pemF0aW9uXHJcbiAgZXhjbHVkZUhvc3BpdGFsSWQ/OiBzdHJpbmc7IC8vIEV4Y2x1ZGUgb3duIGhvc3BpdGFsIChtYXJrZXRwbGFjZSBmb3IgYnV5ZXJzKVxyXG4gIHNvcnQ/OiAnbGF0ZXN0JyB8ICdwcmljZV9hc2MnIHwgJ3ByaWNlX2Rlc2MnO1xyXG4gIGV4cGlyeUFmdGVyPzogRGF0ZTsgLy8gT25seSBzaG93IGxpc3RpbmdzIHdpdGggZXhwaXJ5X2RhdGUgPj0gdGhpcyAob3IgbnVsbClcclxuICBwYWdlPzogbnVtYmVyO1xyXG4gIHBhZ2VTaXplPzogbnVtYmVyO1xyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgTXlMaXN0aW5nc1BhcmFtcyA9IHtcclxuICBob3NwaXRhbElkOiBzdHJpbmc7XHJcbiAgdGl0bGU/OiBzdHJpbmc7IC8vIHBhcnRpYWwgbWF0Y2hcclxuICBjYXRlZ29yeT86IHN0cmluZztcclxuICBzdGF0dXM/OiBMaXN0aW5nU3RhdHVzO1xyXG4gIHBhZ2U/OiBudW1iZXI7XHJcbiAgcGFnZVNpemU/OiBudW1iZXI7XHJcbn07XHJcblxyXG5leHBvcnQgdHlwZSBMaXN0aW5nRm9yVXBkYXRlID0ge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgaG9zcGl0YWxJZDogc3RyaW5nO1xyXG4gIHRpdGxlOiBzdHJpbmc7XHJcbiAgZGVzY3JpcHRpb246IHN0cmluZyB8IG51bGw7XHJcbiAgY2F0ZWdvcnk6IHN0cmluZztcclxuICBxdWFudGl0eUF2YWlsYWJsZTogbnVtYmVyO1xyXG4gIHByaWNlUGVyVW5pdDogUHJpc21hLkRlY2ltYWw7XHJcbiAgZXhwaXJ5RGF0ZTogRGF0ZSB8IG51bGw7XHJcbiAgc3RhdHVzOiBMaXN0aW5nU3RhdHVzO1xyXG4gIGNyZWF0ZWRBdDogRGF0ZTtcclxuICB1cGRhdGVkQXQ6IERhdGU7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgbGlzdGluZ1JlcG9zaXRvcnkgPSB7XHJcbiAgLyoqXHJcbiAgICogU2VhcmNoIG1hcmtldHBsYWNlOiBvbmx5IEFDVElWRSBsaXN0aW5ncywgb3B0aW9uYWwgZmlsdGVycywgcGFnaW5hdGlvbi5cclxuICAgKiBDYWxsZXIgc2hvdWxkIHBhc3MgZXhwaXJ5QWZ0ZXIgPSBuZXcgRGF0ZSgpIHRvIGhpZGUgZXhwaXJlZC5cclxuICAgKi9cclxuICBhc3luYyBmaW5kTWFueVNlYXJjaChwYXJhbXM6IFNlYXJjaExpc3RpbmdzUGFyYW1zKSB7XHJcbiAgICBjb25zdCB7IGNhdGVnb3J5LCBwcmljZU1pbiwgcHJpY2VNYXgsIGhvc3BpdGFsSWQsIGV4Y2x1ZGVIb3NwaXRhbElkLCBzb3J0ID0gJ2xhdGVzdCcsIGV4cGlyeUFmdGVyLCBwYWdlID0gMSwgcGFnZVNpemUgPSAyMCB9ID0gcGFyYW1zO1xyXG4gICAgY29uc3Qgc2tpcCA9IChwYWdlIC0gMSkgKiBwYWdlU2l6ZTtcclxuXHJcbiAgICBjb25zdCB3aGVyZTogUHJpc21hLkxpc3RpbmdXaGVyZUlucHV0ID0ge1xyXG4gICAgICBzdGF0dXM6IExJU1RJTkdfU1RBVFVTX0FDVElWRSxcclxuICAgIH07XHJcbiAgICBpZiAoY2F0ZWdvcnkpIHdoZXJlLmNhdGVnb3J5ID0gY2F0ZWdvcnk7XHJcbiAgICBpZiAoZXhjbHVkZUhvc3BpdGFsSWQpIHdoZXJlLmhvc3BpdGFsSWQgPSB7IG5vdDogZXhjbHVkZUhvc3BpdGFsSWQgfTtcclxuICAgIGVsc2UgaWYgKGhvc3BpdGFsSWQpIHdoZXJlLmhvc3BpdGFsSWQgPSBob3NwaXRhbElkO1xyXG4gICAgaWYgKHByaWNlTWluICE9IG51bGwgfHwgcHJpY2VNYXggIT0gbnVsbCkge1xyXG4gICAgICB3aGVyZS5wcmljZVBlclVuaXQgPSB7XHJcbiAgICAgICAgLi4uKHByaWNlTWluICE9IG51bGwgJiYgeyBndGU6IHByaWNlTWluIH0pLFxyXG4gICAgICAgIC4uLihwcmljZU1heCAhPSBudWxsICYmIHsgbHRlOiBwcmljZU1heCB9KSxcclxuICAgICAgfSBhcyBQcmlzbWEuRGVjaW1hbEZpbHRlcjtcclxuICAgIH1cclxuICAgIGlmIChleHBpcnlBZnRlciAhPSBudWxsKSB7XHJcbiAgICAgIHdoZXJlLk9SID0gW1xyXG4gICAgICAgIHsgZXhwaXJ5RGF0ZTogbnVsbCB9LFxyXG4gICAgICAgIHsgZXhwaXJ5RGF0ZTogeyBndGU6IGV4cGlyeUFmdGVyIH0gfSxcclxuICAgICAgXTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBvcmRlckJ5OiBQcmlzbWEuTGlzdGluZ09yZGVyQnlXaXRoUmVsYXRpb25JbnB1dCA9XHJcbiAgICAgIHNvcnQgPT09ICdwcmljZV9hc2MnID8geyBwcmljZVBlclVuaXQ6ICdhc2MnIH0gOiBzb3J0ID09PSAncHJpY2VfZGVzYycgPyB7IHByaWNlUGVyVW5pdDogJ2Rlc2MnIH0gOiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH07XHJcblxyXG4gICAgY29uc3QgW2l0ZW1zLCB0b3RhbF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgIHByaXNtYS5saXN0aW5nLmZpbmRNYW55KHtcclxuICAgICAgICB3aGVyZSxcclxuICAgICAgICBza2lwLFxyXG4gICAgICAgIHRha2U6IHBhZ2VTaXplLFxyXG4gICAgICAgIG9yZGVyQnksXHJcbiAgICAgICAgaW5jbHVkZTogeyBob3NwaXRhbDogeyBzZWxlY3Q6IHsgaWQ6IHRydWUsIG5hbWU6IHRydWUgfSB9IH0sXHJcbiAgICAgIH0pLFxyXG4gICAgICBwcmlzbWEubGlzdGluZy5jb3VudCh7IHdoZXJlIH0pLFxyXG4gICAgXSk7XHJcblxyXG4gICAgcmV0dXJuIHsgaXRlbXMsIHRvdGFsLCBwYWdlLCBwYWdlU2l6ZSB9O1xyXG4gIH0sXHJcblxyXG4gIGFzeW5jIGZpbmRCeUlkKGlkOiBzdHJpbmcpIHtcclxuICAgIHJldHVybiBwcmlzbWEubGlzdGluZy5maW5kVW5pcXVlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgaW5jbHVkZTogeyBob3NwaXRhbDogeyBzZWxlY3Q6IHsgaWQ6IHRydWUsIG5hbWU6IHRydWUgfSB9IH0sXHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICAvKiogTGlzdGluZ3MgYnkgaG9zcGl0YWwgKGZvciBzZWxsZXIgZGFzaGJvYXJkKSB3aXRoIG9wdGlvbmFsIGZpbHRlcnMuICovXHJcbiAgYXN5bmMgZmluZE1hbnlCeUhvc3BpdGFsKHBhcmFtczogTXlMaXN0aW5nc1BhcmFtcykge1xyXG4gICAgY29uc3QgeyBob3NwaXRhbElkLCB0aXRsZSwgY2F0ZWdvcnksIHN0YXR1cywgcGFnZSA9IDEsIHBhZ2VTaXplID0gMjAgfSA9IHBhcmFtcztcclxuICAgIGNvbnN0IHNraXAgPSAocGFnZSAtIDEpICogcGFnZVNpemU7XHJcbiAgICBjb25zdCB3aGVyZTogUHJpc21hLkxpc3RpbmdXaGVyZUlucHV0ID0geyBob3NwaXRhbElkIH07XHJcbiAgICBpZiAodGl0bGU/LnRyaW0oKSkge1xyXG4gICAgICB3aGVyZS50aXRsZSA9IHsgY29udGFpbnM6IHRpdGxlLnRyaW0oKSwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9O1xyXG4gICAgfVxyXG4gICAgaWYgKGNhdGVnb3J5Py50cmltKCkpIHdoZXJlLmNhdGVnb3J5ID0gY2F0ZWdvcnkudHJpbSgpO1xyXG4gICAgaWYgKHN0YXR1cykgd2hlcmUuc3RhdHVzID0gc3RhdHVzO1xyXG5cclxuICAgIGNvbnN0IFtpdGVtcywgdG90YWxdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xyXG4gICAgICBwcmlzbWEubGlzdGluZy5maW5kTWFueSh7XHJcbiAgICAgICAgd2hlcmUsXHJcbiAgICAgICAgc2tpcCxcclxuICAgICAgICB0YWtlOiBwYWdlU2l6ZSxcclxuICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXHJcbiAgICAgICAgaW5jbHVkZTogeyBob3NwaXRhbDogeyBzZWxlY3Q6IHsgaWQ6IHRydWUsIG5hbWU6IHRydWUgfSB9IH0sXHJcbiAgICAgIH0pLFxyXG4gICAgICBwcmlzbWEubGlzdGluZy5jb3VudCh7IHdoZXJlIH0pLFxyXG4gICAgXSk7XHJcbiAgICByZXR1cm4geyBpdGVtcywgdG90YWwsIHBhZ2UsIHBhZ2VTaXplIH07XHJcbiAgfSxcclxuXHJcbiAgLyoqXHJcbiAgICogTG9jayBsaXN0aW5nIHJvdyBmb3IgdXBkYXRlICh1c2UgaW5zaWRlIHRyYW5zYWN0aW9uKS4gUmV0dXJucyBudWxsIGlmIG5vdCBmb3VuZC5cclxuICAgKiBVc2Ugd2l0aCB0eCBmcm9tIHByaXNtYS4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4KSA9PiAuLi4pLlxyXG4gICAqL1xyXG4gIGFzeW5jIGZpbmRCeUlkRm9yVXBkYXRlKFxyXG4gICAgdHg6IFByaXNtYS5UcmFuc2FjdGlvbkNsaWVudCxcclxuICAgIGlkOiBzdHJpbmdcclxuICApOiBQcm9taXNlPExpc3RpbmdGb3JVcGRhdGUgfCBudWxsPiB7XHJcbiAgICBjb25zdCByb3dzID0gYXdhaXQgdHguJHF1ZXJ5UmF3PFxyXG4gICAgICBBcnJheTx7XHJcbiAgICAgICAgaWQ6IHN0cmluZztcclxuICAgICAgICBob3NwaXRhbF9pZDogc3RyaW5nO1xyXG4gICAgICAgIHRpdGxlOiBzdHJpbmc7XHJcbiAgICAgICAgZGVzY3JpcHRpb246IHN0cmluZyB8IG51bGw7XHJcbiAgICAgICAgY2F0ZWdvcnk6IHN0cmluZztcclxuICAgICAgICBxdWFudGl0eV9hdmFpbGFibGU6IG51bWJlcjtcclxuICAgICAgICBwcmljZV9wZXJfdW5pdDogUHJpc21hLkRlY2ltYWw7XHJcbiAgICAgICAgZXhwaXJ5X2RhdGU6IERhdGUgfCBudWxsO1xyXG4gICAgICAgIHN0YXR1czogc3RyaW5nO1xyXG4gICAgICAgIGNyZWF0ZWRfYXQ6IERhdGU7XHJcbiAgICAgICAgdXBkYXRlZF9hdDogRGF0ZTtcclxuICAgICAgfT5cclxuICAgID4oUHJpc21hLnNxbGBTRUxFQ1QgaWQsIGhvc3BpdGFsX2lkLCB0aXRsZSwgZGVzY3JpcHRpb24sIGNhdGVnb3J5LCBxdWFudGl0eV9hdmFpbGFibGUsIHByaWNlX3Blcl91bml0LCBleHBpcnlfZGF0ZSwgc3RhdHVzLCBjcmVhdGVkX2F0LCB1cGRhdGVkX2F0IEZST00gbGlzdGluZ3MgV0hFUkUgaWQgPSAke2lkfSBGT1IgVVBEQVRFYCk7XHJcblxyXG4gICAgaWYgKHJvd3MubGVuZ3RoID09PSAwKSByZXR1cm4gbnVsbDtcclxuICAgIGNvbnN0IHIgPSByb3dzWzBdO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaWQ6IHIuaWQsXHJcbiAgICAgIGhvc3BpdGFsSWQ6IHIuaG9zcGl0YWxfaWQsXHJcbiAgICAgIHRpdGxlOiByLnRpdGxlLFxyXG4gICAgICBkZXNjcmlwdGlvbjogci5kZXNjcmlwdGlvbixcclxuICAgICAgY2F0ZWdvcnk6IHIuY2F0ZWdvcnksXHJcbiAgICAgIHF1YW50aXR5QXZhaWxhYmxlOiByLnF1YW50aXR5X2F2YWlsYWJsZSxcclxuICAgICAgcHJpY2VQZXJVbml0OiByLnByaWNlX3Blcl91bml0LFxyXG4gICAgICBleHBpcnlEYXRlOiByLmV4cGlyeV9kYXRlLFxyXG4gICAgICBzdGF0dXM6IHIuc3RhdHVzIGFzIExpc3RpbmdTdGF0dXMsXHJcbiAgICAgIGNyZWF0ZWRBdDogci5jcmVhdGVkX2F0LFxyXG4gICAgICB1cGRhdGVkQXQ6IHIudXBkYXRlZF9hdCxcclxuICAgIH07XHJcbiAgfSxcclxuXHJcbiAgLyoqXHJcbiAgICogQXRvbWljOiBzZXQgcXVhbnRpdHlfYXZhaWxhYmxlIGFuZCBvcHRpb25hbGx5IHN0YXR1cyAoZS5nLiBTT0xEX09VVCB3aGVuIDApLlxyXG4gICAqIFVzZSBpbnNpZGUgdHJhbnNhY3Rpb24uXHJcbiAgICovXHJcbiAgYXN5bmMgdXBkYXRlUXVhbnRpdHlBbmRTdGF0dXMoXHJcbiAgICB0eDogUHJpc21hLlRyYW5zYWN0aW9uQ2xpZW50LFxyXG4gICAgbGlzdGluZ0lkOiBzdHJpbmcsXHJcbiAgICBxdWFudGl0eUF2YWlsYWJsZTogbnVtYmVyLFxyXG4gICAgc3RhdHVzOiBMaXN0aW5nU3RhdHVzXHJcbiAgKSB7XHJcbiAgICByZXR1cm4gdHgubGlzdGluZy51cGRhdGUoe1xyXG4gICAgICB3aGVyZTogeyBpZDogbGlzdGluZ0lkIH0sXHJcbiAgICAgIGRhdGE6IHsgcXVhbnRpdHlBdmFpbGFibGUsIHN0YXR1cywgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpIH0sXHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBhc3luYyBjcmVhdGUoZGF0YTogUHJpc21hLkxpc3RpbmdVbmNoZWNrZWRDcmVhdGVJbnB1dCkge1xyXG4gICAgcmV0dXJuIHByaXNtYS5saXN0aW5nLmNyZWF0ZSh7IGRhdGEgfSk7XHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgdXBkYXRlKGlkOiBzdHJpbmcsIGRhdGE6IFByaXNtYS5MaXN0aW5nVW5jaGVja2VkVXBkYXRlSW5wdXQpIHtcclxuICAgIHJldHVybiBwcmlzbWEubGlzdGluZy51cGRhdGUoeyB3aGVyZTogeyBpZCB9LCBkYXRhIH0pO1xyXG4gIH0sXHJcbn07XHJcbiJdLCJuYW1lcyI6WyJQcmlzbWEiLCJwcmlzbWEiLCJMSVNUSU5HX1NUQVRVU19BQ1RJVkUiLCJsaXN0aW5nUmVwb3NpdG9yeSIsImZpbmRNYW55U2VhcmNoIiwicGFyYW1zIiwiY2F0ZWdvcnkiLCJwcmljZU1pbiIsInByaWNlTWF4IiwiaG9zcGl0YWxJZCIsImV4Y2x1ZGVIb3NwaXRhbElkIiwic29ydCIsImV4cGlyeUFmdGVyIiwicGFnZSIsInBhZ2VTaXplIiwic2tpcCIsIndoZXJlIiwic3RhdHVzIiwibm90IiwicHJpY2VQZXJVbml0IiwiZ3RlIiwibHRlIiwiT1IiLCJleHBpcnlEYXRlIiwib3JkZXJCeSIsImNyZWF0ZWRBdCIsIml0ZW1zIiwidG90YWwiLCJQcm9taXNlIiwiYWxsIiwibGlzdGluZyIsImZpbmRNYW55IiwidGFrZSIsImluY2x1ZGUiLCJob3NwaXRhbCIsInNlbGVjdCIsImlkIiwibmFtZSIsImNvdW50IiwiZmluZEJ5SWQiLCJmaW5kVW5pcXVlIiwiZmluZE1hbnlCeUhvc3BpdGFsIiwidGl0bGUiLCJ0cmltIiwiY29udGFpbnMiLCJtb2RlIiwiZmluZEJ5SWRGb3JVcGRhdGUiLCJ0eCIsInJvd3MiLCIkcXVlcnlSYXciLCJzcWwiLCJsZW5ndGgiLCJyIiwiaG9zcGl0YWxfaWQiLCJkZXNjcmlwdGlvbiIsInF1YW50aXR5QXZhaWxhYmxlIiwicXVhbnRpdHlfYXZhaWxhYmxlIiwicHJpY2VfcGVyX3VuaXQiLCJleHBpcnlfZGF0ZSIsImNyZWF0ZWRfYXQiLCJ1cGRhdGVkQXQiLCJ1cGRhdGVkX2F0IiwidXBkYXRlUXVhbnRpdHlBbmRTdGF0dXMiLCJsaXN0aW5nSWQiLCJ1cGRhdGUiLCJkYXRhIiwiRGF0ZSIsImNyZWF0ZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/server/repositories/listing.repository.ts\n");

/***/ }),

/***/ "(rsc)/./src/server/services/listing.service.ts":
/*!************************************************!*\
  !*** ./src/server/services/listing.service.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createListing: () => (/* binding */ createListing),\n/* harmony export */   deactivateListing: () => (/* binding */ deactivateListing),\n/* harmony export */   getListingById: () => (/* binding */ getListingById),\n/* harmony export */   getListingForMarketplace: () => (/* binding */ getListingForMarketplace),\n/* harmony export */   getMyListings: () => (/* binding */ getMyListings),\n/* harmony export */   listingService: () => (/* binding */ listingService),\n/* harmony export */   searchListings: () => (/* binding */ searchListings),\n/* harmony export */   updateListing: () => (/* binding */ updateListing)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _server_repositories_listing_repository__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/server/repositories/listing.repository */ \"(rsc)/./src/server/repositories/listing.repository.ts\");\n/**\r\n * Listing service: business logic for listings.\r\n * - Only ACTIVE listings visible in marketplace; expired auto-hidden.\r\n * - quantity_available = 0  SOLD_OUT. Sellers can set INACTIVE.\r\n * - Delegates DB access to listing.repository.\r\n */ \n\nconst ACTIVE = 'ACTIVE';\nconst SOLD_OUT = 'SOLD_OUT';\nconst INACTIVE = 'INACTIVE';\n/** Marketplace search: only ACTIVE, not expired. */ async function searchListings(params) {\n    const expiryAfter = params.expiryAfter ?? new Date();\n    return _server_repositories_listing_repository__WEBPACK_IMPORTED_MODULE_1__.listingRepository.findManySearch({\n        ...params,\n        expiryAfter\n    });\n}\n/** Get single listing for marketplace; returns null if not ACTIVE or expired. */ async function getListingForMarketplace(id) {\n    const listing = await _server_repositories_listing_repository__WEBPACK_IMPORTED_MODULE_1__.listingRepository.findById(id);\n    if (!listing || listing.status !== ACTIVE) return null;\n    if (listing.expiryDate && listing.expiryDate < new Date()) return null;\n    return listing;\n}\n/** Get by id (for seller's own edit page); no status/expiry filter. */ async function getListingById(id) {\n    return _server_repositories_listing_repository__WEBPACK_IMPORTED_MODULE_1__.listingRepository.findById(id);\n}\n/** My listings (hospital dashboard): filter by title, category, status. */ async function getMyListings(params) {\n    return _server_repositories_listing_repository__WEBPACK_IMPORTED_MODULE_1__.listingRepository.findManyByHospital(params);\n}\nasync function ensureCategoryExists(name) {\n    const trimmed = name.trim();\n    const exists = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.category.findUnique({\n        where: {\n            name: trimmed\n        }\n    });\n    if (!exists) {\n        throw new Error(`Category \"${trimmed}\" is not valid. Please select a category from the list.`);\n    }\n}\nasync function createListing(input) {\n    await ensureCategoryExists(input.category);\n    const expiryDate = input.expiryDate ? new Date(input.expiryDate) : null;\n    const status = ACTIVE;\n    return _server_repositories_listing_repository__WEBPACK_IMPORTED_MODULE_1__.listingRepository.create({\n        hospitalId: input.hospitalId,\n        title: input.title.trim(),\n        description: input.description?.trim() ?? null,\n        category: input.category.trim(),\n        quantityAvailable: Math.max(0, Math.floor(input.quantityAvailable)),\n        pricePerUnit: input.pricePerUnit,\n        expiryDate,\n        status\n    });\n}\nasync function updateListing(id, input, hospitalId// tenant check: only seller can update\n) {\n    const existing = await _server_repositories_listing_repository__WEBPACK_IMPORTED_MODULE_1__.listingRepository.findById(id);\n    if (!existing) return null;\n    if (existing.hospitalId !== hospitalId) return null;\n    const categoryToUse = input.category?.trim() ?? existing.category;\n    if (categoryToUse) await ensureCategoryExists(categoryToUse);\n    const quantityAvailable = input.quantityAvailable != null ? Math.max(0, Math.floor(input.quantityAvailable)) : existing.quantityAvailable;\n    const newStatus = quantityAvailable === 0 ? SOLD_OUT : input.status ?? existing.status;\n    // If explicitly set to INACTIVE, use that\n    const status = input.status === INACTIVE ? INACTIVE : newStatus;\n    return _server_repositories_listing_repository__WEBPACK_IMPORTED_MODULE_1__.listingRepository.update(id, {\n        title: input.title?.trim(),\n        description: input.description !== undefined ? input.description?.trim() ?? null : undefined,\n        category: input.category?.trim(),\n        quantityAvailable,\n        pricePerUnit: input.pricePerUnit,\n        expiryDate: input.expiryDate !== undefined ? input.expiryDate ? new Date(input.expiryDate) : null : undefined,\n        status\n    });\n}\n/** Deactivate listing (seller only). */ async function deactivateListing(id, hospitalId) {\n    return updateListing(id, {\n        status: INACTIVE\n    }, hospitalId);\n}\nconst listingService = {\n    searchListings,\n    getListingForMarketplace,\n    getListingById,\n    getMyListings,\n    createListing,\n    updateListing,\n    deactivateListing\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvc2VydmVyL3NlcnZpY2VzL2xpc3Rpbmcuc2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUE7Ozs7O0NBS0MsR0FHcUM7QUFDdUM7QUFHN0UsTUFBTUUsU0FBd0I7QUFDOUIsTUFBTUMsV0FBMEI7QUFDaEMsTUFBTUMsV0FBMEI7QUFzQmhDLGtEQUFrRCxHQUMzQyxlQUFlQyxlQUFlQyxNQUE0QjtJQUMvRCxNQUFNQyxjQUFjRCxPQUFPQyxXQUFXLElBQUksSUFBSUM7SUFDOUMsT0FBT1Asc0ZBQWlCQSxDQUFDUSxjQUFjLENBQUM7UUFDdEMsR0FBR0gsTUFBTTtRQUNUQztJQUNGO0FBQ0Y7QUFFQSwrRUFBK0UsR0FDeEUsZUFBZUcseUJBQXlCQyxFQUFVO0lBQ3ZELE1BQU1DLFVBQVUsTUFBTVgsc0ZBQWlCQSxDQUFDWSxRQUFRLENBQUNGO0lBQ2pELElBQUksQ0FBQ0MsV0FBV0EsUUFBUUUsTUFBTSxLQUFLWixRQUFRLE9BQU87SUFDbEQsSUFBSVUsUUFBUUcsVUFBVSxJQUFJSCxRQUFRRyxVQUFVLEdBQUcsSUFBSVAsUUFBUSxPQUFPO0lBQ2xFLE9BQU9JO0FBQ1Q7QUFFQSxxRUFBcUUsR0FDOUQsZUFBZUksZUFBZUwsRUFBVTtJQUM3QyxPQUFPVixzRkFBaUJBLENBQUNZLFFBQVEsQ0FBQ0Y7QUFDcEM7QUFFQSx5RUFBeUUsR0FDbEUsZUFBZU0sY0FBY1gsTUFBd0I7SUFDMUQsT0FBT0wsc0ZBQWlCQSxDQUFDaUIsa0JBQWtCLENBQUNaO0FBQzlDO0FBRUEsZUFBZWEscUJBQXFCQyxJQUFZO0lBQzlDLE1BQU1DLFVBQVVELEtBQUtFLElBQUk7SUFDekIsTUFBTUMsU0FBUyxNQUFNdkIsK0NBQU1BLENBQUN3QixRQUFRLENBQUNDLFVBQVUsQ0FBQztRQUFFQyxPQUFPO1lBQUVOLE1BQU1DO1FBQVE7SUFBRTtJQUMzRSxJQUFJLENBQUNFLFFBQVE7UUFDWCxNQUFNLElBQUlJLE1BQU0sQ0FBQyxVQUFVLEVBQUVOLFFBQVEsdURBQXVELENBQUM7SUFDL0Y7QUFDRjtBQUVPLGVBQWVPLGNBQWNDLEtBQXlCO0lBQzNELE1BQU1WLHFCQUFxQlUsTUFBTUwsUUFBUTtJQUN6QyxNQUFNVCxhQUFhYyxNQUFNZCxVQUFVLEdBQUcsSUFBSVAsS0FBS3FCLE1BQU1kLFVBQVUsSUFBSTtJQUNuRSxNQUFNRCxTQUF3Qlo7SUFDOUIsT0FBT0Qsc0ZBQWlCQSxDQUFDNkIsTUFBTSxDQUFDO1FBQzlCQyxZQUFZRixNQUFNRSxVQUFVO1FBQzVCQyxPQUFPSCxNQUFNRyxLQUFLLENBQUNWLElBQUk7UUFDdkJXLGFBQWFKLE1BQU1JLFdBQVcsRUFBRVgsVUFBVTtRQUMxQ0UsVUFBVUssTUFBTUwsUUFBUSxDQUFDRixJQUFJO1FBQzdCWSxtQkFBbUJDLEtBQUtDLEdBQUcsQ0FBQyxHQUFHRCxLQUFLRSxLQUFLLENBQUNSLE1BQU1LLGlCQUFpQjtRQUNqRUksY0FBY1QsTUFBTVMsWUFBWTtRQUNoQ3ZCO1FBQ0FEO0lBQ0Y7QUFDRjtBQUVPLGVBQWV5QixjQUNwQjVCLEVBQVUsRUFDVmtCLEtBQXlCLEVBQ3pCRSxVQUFrQix1Q0FBd0M7O0lBRTFELE1BQU1TLFdBQVcsTUFBTXZDLHNGQUFpQkEsQ0FBQ1ksUUFBUSxDQUFDRjtJQUNsRCxJQUFJLENBQUM2QixVQUFVLE9BQU87SUFDdEIsSUFBSUEsU0FBU1QsVUFBVSxLQUFLQSxZQUFZLE9BQU87SUFFL0MsTUFBTVUsZ0JBQWdCWixNQUFNTCxRQUFRLEVBQUVGLFVBQVVrQixTQUFTaEIsUUFBUTtJQUNqRSxJQUFJaUIsZUFBZSxNQUFNdEIscUJBQXFCc0I7SUFFOUMsTUFBTVAsb0JBQ0pMLE1BQU1LLGlCQUFpQixJQUFJLE9BQ3ZCQyxLQUFLQyxHQUFHLENBQUMsR0FBR0QsS0FBS0UsS0FBSyxDQUFDUixNQUFNSyxpQkFBaUIsS0FDOUNNLFNBQVNOLGlCQUFpQjtJQUNoQyxNQUFNUSxZQUNKUixzQkFBc0IsSUFBSS9CLFdBQVkwQixNQUFNZixNQUFNLElBQUkwQixTQUFTMUIsTUFBTTtJQUN2RSwwQ0FBMEM7SUFDMUMsTUFBTUEsU0FBU2UsTUFBTWYsTUFBTSxLQUFLVixXQUFXQSxXQUFXc0M7SUFFdEQsT0FBT3pDLHNGQUFpQkEsQ0FBQzBDLE1BQU0sQ0FBQ2hDLElBQUk7UUFDbENxQixPQUFPSCxNQUFNRyxLQUFLLEVBQUVWO1FBQ3BCVyxhQUFhSixNQUFNSSxXQUFXLEtBQUtXLFlBQVlmLE1BQU1JLFdBQVcsRUFBRVgsVUFBVSxPQUFPc0I7UUFDbkZwQixVQUFVSyxNQUFNTCxRQUFRLEVBQUVGO1FBQzFCWTtRQUNBSSxjQUFjVCxNQUFNUyxZQUFZO1FBQ2hDdkIsWUFBWWMsTUFBTWQsVUFBVSxLQUFLNkIsWUFBYWYsTUFBTWQsVUFBVSxHQUFHLElBQUlQLEtBQUtxQixNQUFNZCxVQUFVLElBQUksT0FBUTZCO1FBQ3RHOUI7SUFDRjtBQUNGO0FBRUEsc0NBQXNDLEdBQy9CLGVBQWUrQixrQkFBa0JsQyxFQUFVLEVBQUVvQixVQUFrQjtJQUNwRSxPQUFPUSxjQUFjNUIsSUFBSTtRQUFFRyxRQUFRVjtJQUFTLEdBQUcyQjtBQUNqRDtBQUVPLE1BQU1lLGlCQUFpQjtJQUM1QnpDO0lBQ0FLO0lBQ0FNO0lBQ0FDO0lBQ0FXO0lBQ0FXO0lBQ0FNO0FBQ0YsRUFBRSIsInNvdXJjZXMiOlsiQzpcXHByb2plY3RzXFxiMmJzaXRlc1xcc3JjXFxzZXJ2ZXJcXHNlcnZpY2VzXFxsaXN0aW5nLnNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIExpc3Rpbmcgc2VydmljZTogYnVzaW5lc3MgbG9naWMgZm9yIGxpc3RpbmdzLlxyXG4gKiAtIE9ubHkgQUNUSVZFIGxpc3RpbmdzIHZpc2libGUgaW4gbWFya2V0cGxhY2U7IGV4cGlyZWQgYXV0by1oaWRkZW4uXHJcbiAqIC0gcXVhbnRpdHlfYXZhaWxhYmxlID0gMCDihpIgU09MRF9PVVQuIFNlbGxlcnMgY2FuIHNldCBJTkFDVElWRS5cclxuICogLSBEZWxlZ2F0ZXMgREIgYWNjZXNzIHRvIGxpc3RpbmcucmVwb3NpdG9yeS5cclxuICovXHJcblxyXG5pbXBvcnQgdHlwZSB7IExpc3RpbmdTdGF0dXMgfSBmcm9tICdAcHJpc21hL2NsaWVudCc7XHJcbmltcG9ydCB7IHByaXNtYSB9IGZyb20gJ0AvbGliL3ByaXNtYSc7XHJcbmltcG9ydCB7IGxpc3RpbmdSZXBvc2l0b3J5IH0gZnJvbSAnQC9zZXJ2ZXIvcmVwb3NpdG9yaWVzL2xpc3RpbmcucmVwb3NpdG9yeSc7XHJcbmltcG9ydCB0eXBlIHsgU2VhcmNoTGlzdGluZ3NQYXJhbXMsIE15TGlzdGluZ3NQYXJhbXMgfSBmcm9tICdAL3NlcnZlci9yZXBvc2l0b3JpZXMvbGlzdGluZy5yZXBvc2l0b3J5JztcclxuXHJcbmNvbnN0IEFDVElWRTogTGlzdGluZ1N0YXR1cyA9ICdBQ1RJVkUnO1xyXG5jb25zdCBTT0xEX09VVDogTGlzdGluZ1N0YXR1cyA9ICdTT0xEX09VVCc7XHJcbmNvbnN0IElOQUNUSVZFOiBMaXN0aW5nU3RhdHVzID0gJ0lOQUNUSVZFJztcclxuXHJcbmV4cG9ydCB0eXBlIENyZWF0ZUxpc3RpbmdJbnB1dCA9IHtcclxuICBob3NwaXRhbElkOiBzdHJpbmc7XHJcbiAgdGl0bGU6IHN0cmluZztcclxuICBkZXNjcmlwdGlvbj86IHN0cmluZyB8IG51bGw7XHJcbiAgY2F0ZWdvcnk6IHN0cmluZztcclxuICBxdWFudGl0eUF2YWlsYWJsZTogbnVtYmVyO1xyXG4gIHByaWNlUGVyVW5pdDogbnVtYmVyO1xyXG4gIGV4cGlyeURhdGU/OiBzdHJpbmcgfCBudWxsOyAvLyBJU08gZGF0ZVxyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgVXBkYXRlTGlzdGluZ0lucHV0ID0ge1xyXG4gIHRpdGxlPzogc3RyaW5nO1xyXG4gIGRlc2NyaXB0aW9uPzogc3RyaW5nIHwgbnVsbDtcclxuICBjYXRlZ29yeT86IHN0cmluZztcclxuICBxdWFudGl0eUF2YWlsYWJsZT86IG51bWJlcjtcclxuICBwcmljZVBlclVuaXQ/OiBudW1iZXI7XHJcbiAgZXhwaXJ5RGF0ZT86IHN0cmluZyB8IG51bGw7XHJcbiAgc3RhdHVzPzogTGlzdGluZ1N0YXR1czsgLy8gSU5BQ1RJVkUgdG8gZGVhY3RpdmF0ZVxyXG59O1xyXG5cclxuLyoqIE1hcmtldHBsYWNlIHNlYXJjaDogb25seSBBQ1RJVkUsIG5vdCBleHBpcmVkLiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VhcmNoTGlzdGluZ3MocGFyYW1zOiBTZWFyY2hMaXN0aW5nc1BhcmFtcykge1xyXG4gIGNvbnN0IGV4cGlyeUFmdGVyID0gcGFyYW1zLmV4cGlyeUFmdGVyID8/IG5ldyBEYXRlKCk7XHJcbiAgcmV0dXJuIGxpc3RpbmdSZXBvc2l0b3J5LmZpbmRNYW55U2VhcmNoKHtcclxuICAgIC4uLnBhcmFtcyxcclxuICAgIGV4cGlyeUFmdGVyLFxyXG4gIH0pO1xyXG59XHJcblxyXG4vKiogR2V0IHNpbmdsZSBsaXN0aW5nIGZvciBtYXJrZXRwbGFjZTsgcmV0dXJucyBudWxsIGlmIG5vdCBBQ1RJVkUgb3IgZXhwaXJlZC4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldExpc3RpbmdGb3JNYXJrZXRwbGFjZShpZDogc3RyaW5nKSB7XHJcbiAgY29uc3QgbGlzdGluZyA9IGF3YWl0IGxpc3RpbmdSZXBvc2l0b3J5LmZpbmRCeUlkKGlkKTtcclxuICBpZiAoIWxpc3RpbmcgfHwgbGlzdGluZy5zdGF0dXMgIT09IEFDVElWRSkgcmV0dXJuIG51bGw7XHJcbiAgaWYgKGxpc3RpbmcuZXhwaXJ5RGF0ZSAmJiBsaXN0aW5nLmV4cGlyeURhdGUgPCBuZXcgRGF0ZSgpKSByZXR1cm4gbnVsbDtcclxuICByZXR1cm4gbGlzdGluZztcclxufVxyXG5cclxuLyoqIEdldCBieSBpZCAoZm9yIHNlbGxlcidzIG93biBlZGl0IHBhZ2UpOyBubyBzdGF0dXMvZXhwaXJ5IGZpbHRlci4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldExpc3RpbmdCeUlkKGlkOiBzdHJpbmcpIHtcclxuICByZXR1cm4gbGlzdGluZ1JlcG9zaXRvcnkuZmluZEJ5SWQoaWQpO1xyXG59XHJcblxyXG4vKiogTXkgbGlzdGluZ3MgKGhvc3BpdGFsIGRhc2hib2FyZCk6IGZpbHRlciBieSB0aXRsZSwgY2F0ZWdvcnksIHN0YXR1cy4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE15TGlzdGluZ3MocGFyYW1zOiBNeUxpc3RpbmdzUGFyYW1zKSB7XHJcbiAgcmV0dXJuIGxpc3RpbmdSZXBvc2l0b3J5LmZpbmRNYW55QnlIb3NwaXRhbChwYXJhbXMpO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBlbnN1cmVDYXRlZ29yeUV4aXN0cyhuYW1lOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCB0cmltbWVkID0gbmFtZS50cmltKCk7XHJcbiAgY29uc3QgZXhpc3RzID0gYXdhaXQgcHJpc21hLmNhdGVnb3J5LmZpbmRVbmlxdWUoeyB3aGVyZTogeyBuYW1lOiB0cmltbWVkIH0gfSk7XHJcbiAgaWYgKCFleGlzdHMpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihgQ2F0ZWdvcnkgXCIke3RyaW1tZWR9XCIgaXMgbm90IHZhbGlkLiBQbGVhc2Ugc2VsZWN0IGEgY2F0ZWdvcnkgZnJvbSB0aGUgbGlzdC5gKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVMaXN0aW5nKGlucHV0OiBDcmVhdGVMaXN0aW5nSW5wdXQpIHtcclxuICBhd2FpdCBlbnN1cmVDYXRlZ29yeUV4aXN0cyhpbnB1dC5jYXRlZ29yeSk7XHJcbiAgY29uc3QgZXhwaXJ5RGF0ZSA9IGlucHV0LmV4cGlyeURhdGUgPyBuZXcgRGF0ZShpbnB1dC5leHBpcnlEYXRlKSA6IG51bGw7XHJcbiAgY29uc3Qgc3RhdHVzOiBMaXN0aW5nU3RhdHVzID0gQUNUSVZFO1xyXG4gIHJldHVybiBsaXN0aW5nUmVwb3NpdG9yeS5jcmVhdGUoe1xyXG4gICAgaG9zcGl0YWxJZDogaW5wdXQuaG9zcGl0YWxJZCxcclxuICAgIHRpdGxlOiBpbnB1dC50aXRsZS50cmltKCksXHJcbiAgICBkZXNjcmlwdGlvbjogaW5wdXQuZGVzY3JpcHRpb24/LnRyaW0oKSA/PyBudWxsLFxyXG4gICAgY2F0ZWdvcnk6IGlucHV0LmNhdGVnb3J5LnRyaW0oKSxcclxuICAgIHF1YW50aXR5QXZhaWxhYmxlOiBNYXRoLm1heCgwLCBNYXRoLmZsb29yKGlucHV0LnF1YW50aXR5QXZhaWxhYmxlKSksXHJcbiAgICBwcmljZVBlclVuaXQ6IGlucHV0LnByaWNlUGVyVW5pdCxcclxuICAgIGV4cGlyeURhdGUsXHJcbiAgICBzdGF0dXMsXHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVMaXN0aW5nKFxyXG4gIGlkOiBzdHJpbmcsXHJcbiAgaW5wdXQ6IFVwZGF0ZUxpc3RpbmdJbnB1dCxcclxuICBob3NwaXRhbElkOiBzdHJpbmcgLy8gdGVuYW50IGNoZWNrOiBvbmx5IHNlbGxlciBjYW4gdXBkYXRlXHJcbikge1xyXG4gIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgbGlzdGluZ1JlcG9zaXRvcnkuZmluZEJ5SWQoaWQpO1xyXG4gIGlmICghZXhpc3RpbmcpIHJldHVybiBudWxsO1xyXG4gIGlmIChleGlzdGluZy5ob3NwaXRhbElkICE9PSBob3NwaXRhbElkKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgY29uc3QgY2F0ZWdvcnlUb1VzZSA9IGlucHV0LmNhdGVnb3J5Py50cmltKCkgPz8gZXhpc3RpbmcuY2F0ZWdvcnk7XHJcbiAgaWYgKGNhdGVnb3J5VG9Vc2UpIGF3YWl0IGVuc3VyZUNhdGVnb3J5RXhpc3RzKGNhdGVnb3J5VG9Vc2UpO1xyXG5cclxuICBjb25zdCBxdWFudGl0eUF2YWlsYWJsZSA9XHJcbiAgICBpbnB1dC5xdWFudGl0eUF2YWlsYWJsZSAhPSBudWxsXHJcbiAgICAgID8gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihpbnB1dC5xdWFudGl0eUF2YWlsYWJsZSkpXHJcbiAgICAgIDogZXhpc3RpbmcucXVhbnRpdHlBdmFpbGFibGU7XHJcbiAgY29uc3QgbmV3U3RhdHVzOiBMaXN0aW5nU3RhdHVzID1cclxuICAgIHF1YW50aXR5QXZhaWxhYmxlID09PSAwID8gU09MRF9PVVQgOiAoaW5wdXQuc3RhdHVzID8/IGV4aXN0aW5nLnN0YXR1cyk7XHJcbiAgLy8gSWYgZXhwbGljaXRseSBzZXQgdG8gSU5BQ1RJVkUsIHVzZSB0aGF0XHJcbiAgY29uc3Qgc3RhdHVzID0gaW5wdXQuc3RhdHVzID09PSBJTkFDVElWRSA/IElOQUNUSVZFIDogbmV3U3RhdHVzO1xyXG5cclxuICByZXR1cm4gbGlzdGluZ1JlcG9zaXRvcnkudXBkYXRlKGlkLCB7XHJcbiAgICB0aXRsZTogaW5wdXQudGl0bGU/LnRyaW0oKSxcclxuICAgIGRlc2NyaXB0aW9uOiBpbnB1dC5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkID8gaW5wdXQuZGVzY3JpcHRpb24/LnRyaW0oKSA/PyBudWxsIDogdW5kZWZpbmVkLFxyXG4gICAgY2F0ZWdvcnk6IGlucHV0LmNhdGVnb3J5Py50cmltKCksXHJcbiAgICBxdWFudGl0eUF2YWlsYWJsZSxcclxuICAgIHByaWNlUGVyVW5pdDogaW5wdXQucHJpY2VQZXJVbml0LFxyXG4gICAgZXhwaXJ5RGF0ZTogaW5wdXQuZXhwaXJ5RGF0ZSAhPT0gdW5kZWZpbmVkID8gKGlucHV0LmV4cGlyeURhdGUgPyBuZXcgRGF0ZShpbnB1dC5leHBpcnlEYXRlKSA6IG51bGwpIDogdW5kZWZpbmVkLFxyXG4gICAgc3RhdHVzLFxyXG4gIH0pO1xyXG59XHJcblxyXG4vKiogRGVhY3RpdmF0ZSBsaXN0aW5nIChzZWxsZXIgb25seSkuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWFjdGl2YXRlTGlzdGluZyhpZDogc3RyaW5nLCBob3NwaXRhbElkOiBzdHJpbmcpIHtcclxuICByZXR1cm4gdXBkYXRlTGlzdGluZyhpZCwgeyBzdGF0dXM6IElOQUNUSVZFIH0sIGhvc3BpdGFsSWQpO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgbGlzdGluZ1NlcnZpY2UgPSB7XHJcbiAgc2VhcmNoTGlzdGluZ3MsXHJcbiAgZ2V0TGlzdGluZ0Zvck1hcmtldHBsYWNlLFxyXG4gIGdldExpc3RpbmdCeUlkLFxyXG4gIGdldE15TGlzdGluZ3MsXHJcbiAgY3JlYXRlTGlzdGluZyxcclxuICB1cGRhdGVMaXN0aW5nLFxyXG4gIGRlYWN0aXZhdGVMaXN0aW5nLFxyXG59O1xyXG4iXSwibmFtZXMiOlsicHJpc21hIiwibGlzdGluZ1JlcG9zaXRvcnkiLCJBQ1RJVkUiLCJTT0xEX09VVCIsIklOQUNUSVZFIiwic2VhcmNoTGlzdGluZ3MiLCJwYXJhbXMiLCJleHBpcnlBZnRlciIsIkRhdGUiLCJmaW5kTWFueVNlYXJjaCIsImdldExpc3RpbmdGb3JNYXJrZXRwbGFjZSIsImlkIiwibGlzdGluZyIsImZpbmRCeUlkIiwic3RhdHVzIiwiZXhwaXJ5RGF0ZSIsImdldExpc3RpbmdCeUlkIiwiZ2V0TXlMaXN0aW5ncyIsImZpbmRNYW55QnlIb3NwaXRhbCIsImVuc3VyZUNhdGVnb3J5RXhpc3RzIiwibmFtZSIsInRyaW1tZWQiLCJ0cmltIiwiZXhpc3RzIiwiY2F0ZWdvcnkiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJFcnJvciIsImNyZWF0ZUxpc3RpbmciLCJpbnB1dCIsImNyZWF0ZSIsImhvc3BpdGFsSWQiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwicXVhbnRpdHlBdmFpbGFibGUiLCJNYXRoIiwibWF4IiwiZmxvb3IiLCJwcmljZVBlclVuaXQiLCJ1cGRhdGVMaXN0aW5nIiwiZXhpc3RpbmciLCJjYXRlZ29yeVRvVXNlIiwibmV3U3RhdHVzIiwidXBkYXRlIiwidW5kZWZpbmVkIiwiZGVhY3RpdmF0ZUxpc3RpbmciLCJsaXN0aW5nU2VydmljZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/server/services/listing.service.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/server/app-render/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/action-async-storage.external.js");

/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "./work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("@prisma/client");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "next/dist/shared/lib/no-fallback-error.external":
/*!******************************************************************!*\
  !*** external "next/dist/shared/lib/no-fallback-error.external" ***!
  \******************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/no-fallback-error.external");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/app-paths":
/*!**************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/app-paths" ***!
  \**************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/app-paths");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("querystring");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/next-auth","vendor-chunks/@babel","vendor-chunks/jose","vendor-chunks/zod","vendor-chunks/openid-client","vendor-chunks/bcryptjs","vendor-chunks/oauth","vendor-chunks/object-hash","vendor-chunks/preact","vendor-chunks/uuid","vendor-chunks/yallist","vendor-chunks/preact-render-to-string","vendor-chunks/lru-cache","vendor-chunks/cookie","vendor-chunks/oidc-token-hash","vendor-chunks/@panva"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Flistings%2Fmy%2Froute&page=%2Fapi%2Flistings%2Fmy%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Flistings%2Fmy%2Froute.ts&appDir=C%3A%5Cprojects%5Cb2bsites%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cprojects%5Cb2bsites&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!")));
module.exports = __webpack_exports__;

})();